# æ¡Œé¢ç«¯ç•Œé¢äº¤äº’è®¾è®¡

## 1. è®¾è®¡ç†å¿µ

### 1.1 è®¾è®¡åŸåˆ™

- **éšè”½æ€§ä¼˜å…ˆ**: ç•Œé¢è®¾è®¡ä»¥ä¸è¢«å‘ç°ä¸ºé¦–è¦ç›®æ ‡
- **æ•ˆç‡è‡³ä¸Š**: å¿«é€Ÿå“åº”ï¼Œä¸€é”®æ“ä½œ
- **ç®€æ´æ˜äº†**: ä¿¡æ¯å±‚æ¬¡æ¸…æ™°ï¼Œé¿å…å¹²æ‰°
- **æ™ºèƒ½é€‚åº”**: æ ¹æ®ä½¿ç”¨åœºæ™¯è‡ªåŠ¨è°ƒæ•´

### 1.2 ç”¨æˆ·ä½“éªŒç›®æ ‡

- é›¶å­¦ä¹ æˆæœ¬çš„ç›´è§‚æ“ä½œ
- æ¯«ç§’çº§çš„å“åº”é€Ÿåº¦
- æ— æ„ŸçŸ¥çš„éšç§ä¿æŠ¤
- ä¸“ä¸šçš„é¢è¯•è¾…åŠ©æ•ˆæœ

## 2. ç•Œé¢å¸ƒå±€è®¾è®¡

### 2.1 ä¸»ç•Œé¢ç»“æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ”µ OfferHelper              â”€  Ã—   â”‚ â† æ ‡é¢˜æ  (40px)
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸŸ¢ æ­£åœ¨ç›‘å¬...                      â”‚ â† çŠ¶æ€æ  (50px)
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ“ é¢è¯•å®˜é—®é¢˜                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ è¯·ä»‹ç»ä¸€ä¸‹ä½ çš„é¡¹ç›®ç»éªŒ...        â”‚ â”‚ â† é—®é¢˜æ˜¾ç¤ºåŒº (100px)
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ’¡ å»ºè®®å›ç­”                 ç½®ä¿¡åº¦85% â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ æˆ‘åœ¨ä¹‹å‰çš„å·¥ä½œä¸­ä¸»è¦è´Ÿè´£...      â”‚ â”‚
â”‚  â”‚                                 â”‚ â”‚ â† ç­”æ¡ˆæ˜¾ç¤ºåŒº (200px)
â”‚  â”‚ å…³é”®è¯: React, Node.js, é¡¹ç›®ç®¡ç† â”‚ â”‚
â”‚  â”‚                                 â”‚ â”‚
â”‚  â”‚ ğŸ’¡ å›ç­”å»ºè®®:                    â”‚ â”‚
â”‚  â”‚ â€¢ ç»“åˆå…·ä½“é¡¹ç›®æ¡ˆä¾‹              â”‚ â”‚
â”‚  â”‚ â€¢ çªå‡ºæŠ€æœ¯éš¾ç‚¹å’Œè§£å†³æ–¹æ¡ˆ        â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  [ğŸ¤ å¼€å§‹ç›‘å¬]  [ğŸ‘ éšè—åŠ©æ‰‹]        â”‚ â† æ§åˆ¶é¢æ¿ (60px)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
æ€»é«˜åº¦: 450px, å®½åº¦: 380px
```

### 2.2 å“åº”å¼å¸ƒå±€

```css
/* åŸºç¡€å¸ƒå±€ */
.app-container {
  width: 380px;
  min-height: 450px;
  max-height: 80vh;
  background: rgba(0, 0, 0, 0.92);
  border-radius: 16px;
  border: 1px solid rgba(255, 255, 255, 0.1);
  backdrop-filter: blur(20px);
  box-shadow:
    0 20px 40px rgba(0, 0, 0, 0.4),
    0 0 0 1px rgba(255, 255, 255, 0.05);
  overflow: hidden;
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
}

/* ç´§å‡‘æ¨¡å¼ */
.app-container.compact {
  width: 320px;
  min-height: 200px;
}

/* å±•å¼€æ¨¡å¼ */
.app-container.expanded {
  width: 450px;
  max-height: 90vh;
}

/* è¿·ä½ æ¨¡å¼ */
.app-container.mini {
  width: 60px;
  height: 60px;
  border-radius: 50%;
}
```

## 3. ç»„ä»¶è®¾è®¡è§„èŒƒ

### 3.1 æ ‡é¢˜æ ç»„ä»¶

```tsx
interface TitleBarProps {
  title: string;
  onMinimize: () => void;
  onClose: () => void;
  onDoubleClick: () => void;
}

const TitleBar: React.FC<TitleBarProps> = ({
  title,
  onMinimize,
  onClose,
  onDoubleClick
}) => {
  return (
    <div
      className="title-bar"
      onDoubleClick={onDoubleClick}
    >
      <div className="title-content">
        <div className="app-icon">ğŸ¯</div>
        <span className="app-title">{title}</span>
      </div>

      <div className="window-controls">
        <button
          className="control-btn minimize"
          onClick={onMinimize}
          title="æœ€å°åŒ–"
        >
          <MinusIcon size={12} />
        </button>
        <button
          className="control-btn close"
          onClick={onClose}
          title="éšè—"
        >
          <XIcon size={12} />
        </button>
      </div>
    </div>
  );
};
```

### 3.2 çŠ¶æ€æŒ‡ç¤ºå™¨ç»„ä»¶

```tsx
interface StatusIndicatorProps {
  status: 'idle' | 'listening' | 'analyzing' | 'hidden';
  confidence?: number;
  isOnline: boolean;
}

const StatusIndicator: React.FC<StatusIndicatorProps> = ({
  status,
  confidence,
  isOnline
}) => {
  const getStatusConfig = () => {
    switch (status) {
      case 'listening':
        return {
          color: '#10b981',
          icon: 'ğŸ¤',
          text: 'æ­£åœ¨ç›‘å¬...',
          animation: 'pulse'
        };
      case 'analyzing':
        return {
          color: '#f59e0b',
          icon: 'ğŸ§ ',
          text: 'AIåˆ†æä¸­...',
          animation: 'spin'
        };
      case 'hidden':
        return {
          color: '#6b7280',
          icon: 'ğŸ‘â€ğŸ—¨',
          text: 'å·²éšè—',
          animation: 'none'
        };
      default:
        return {
          color: '#6b7280',
          icon: 'â¸',
          text: 'å¾…æœºä¸­',
          animation: 'none'
        };
    }
  };

  const config = getStatusConfig();

  return (
    <div className="status-indicator">
      <div className="status-main">
        <div
          className={`status-dot ${config.animation}`}
          style={{ backgroundColor: config.color }}
        >
          {config.animation === 'pulse' && <div className="pulse-ring" />}
          {config.animation === 'spin' && <div className="spin-ring" />}
        </div>

        <div className="status-info">
          <span className="status-text">{config.text}</span>
          {confidence && (
            <div className="confidence-indicator">
              <span className="confidence-text">ç½®ä¿¡åº¦: {Math.round(confidence * 100)}%</span>
              <div className="confidence-bar">
                <div
                  className="confidence-fill"
                  style={{ width: `${confidence * 100}%` }}
                />
              </div>
            </div>
          )}
        </div>
      </div>

      <div className="connection-status">
        <div className={`connection-dot ${isOnline ? 'online' : 'offline'}`} />
        <span className="connection-text">
          {isOnline ? 'åœ¨çº¿' : 'ç¦»çº¿'}
        </span>
      </div>
    </div>
  );
};
```

### 3.3 é—®é¢˜æ˜¾ç¤ºç»„ä»¶

```tsx
interface QuestionDisplayProps {
  question: string;
  isListening: boolean;
  interimResult?: string;
}

const QuestionDisplay: React.FC<QuestionDisplayProps> = ({
  question,
  isListening,
  interimResult
}) => {
  return (
    <div className="question-display">
      <div className="question-header">
        <h3>é¢è¯•å®˜é—®é¢˜</h3>
        <div className="question-actions">
          <button className="action-btn" title="å¤åˆ¶é—®é¢˜">
            <CopyIcon size={14} />
          </button>
          <button className="action-btn" title="æ¸…é™¤é—®é¢˜">
            <TrashIcon size={14} />
          </button>
        </div>
      </div>

      <div className="question-content">
        {question ? (
          <div className="question-text final">{question}</div>
        ) : isListening ? (
          <div className="question-text listening">
            {interimResult || 'æ­£åœ¨ç›‘å¬é¢è¯•å®˜æé—®...'}
            <span className="cursor-blink">|</span>
          </div>
        ) : (
          <div className="question-text placeholder">
            ç‚¹å‡»"å¼€å§‹ç›‘å¬"æŒ‰é’®å¼€å§‹è¯†åˆ«é¢è¯•å®˜é—®é¢˜
          </div>
        )}
      </div>

      {isListening && (
        <div className="audio-visualizer">
          <div className="wave-bar" style={{ animationDelay: '0ms' }} />
          <div className="wave-bar" style={{ animationDelay: '100ms' }} />
          <div className="wave-bar" style={{ animationDelay: '200ms' }} />
          <div className="wave-bar" style={{ animationDelay: '300ms' }} />
          <div className="wave-bar" style={{ animationDelay: '400ms' }} />
        </div>
      )}
    </div>
  );
};
```

### 3.4 ç­”æ¡ˆé¢æ¿ç»„ä»¶

```tsx
interface AnswerPanelProps {
  response: AIResponse;
  isLoading: boolean;
  onCopy: () => void;
  onRegenerate: () => void;
  onClose: () => void;
}

const AnswerPanel: React.FC<AnswerPanelProps> = ({
  response,
  isLoading,
  onCopy,
  onRegenerate,
  onClose
}) => {
  if (isLoading) {
    return (
      <div className="answer-panel loading">
        <div className="loading-header">
          <div className="loading-icon">ğŸ§ </div>
          <span>AIæ­£åœ¨åˆ†æé—®é¢˜...</span>
        </div>
        <div className="loading-animation">
          <div className="loading-dots">
            <span></span>
            <span></span>
            <span></span>
          </div>
        </div>
      </div>
    );
  }

  if (!response) return null;

  return (
    <motion.div
      className="answer-panel"
      initial={{ opacity: 0, y: 20, scale: 0.95 }}
      animate={{ opacity: 1, y: 0, scale: 1 }}
      exit={{ opacity: 0, y: -20, scale: 0.95 }}
      transition={{ duration: 0.3, ease: "easeOut" }}
    >
      <div className="answer-header">
        <div className="answer-title">
          <h3>ğŸ’¡ å»ºè®®å›ç­”</h3>
          <div className="confidence-badge">
            ç½®ä¿¡åº¦: {Math.round(response.confidence * 100)}%
          </div>
        </div>

        <div className="answer-actions">
          <button
            className="action-btn"
            onClick={onCopy}
            title="å¤åˆ¶å›ç­”"
          >
            <CopyIcon size={14} />
          </button>
          <button
            className="action-btn"
            onClick={onRegenerate}
            title="é‡æ–°ç”Ÿæˆ"
          >
            <RefreshIcon size={14} />
          </button>
          <button
            className="action-btn close"
            onClick={onClose}
            title="å…³é—­"
          >
            <XIcon size={14} />
          </button>
        </div>
      </div>

      <div className="answer-content">
        <div className="answer-text">
          {response.answer}
        </div>

        {response.keywords.length > 0 && (
          <div className="keywords-section">
            <span className="section-label">å…³é”®è¯:</span>
            <div className="keywords-list">
              {response.keywords.map((keyword, index) => (
                <span key={index} className="keyword-tag">
                  {keyword}
                </span>
              ))}
            </div>
          </div>
        )}

        {response.suggestions.length > 0 && (
          <div className="suggestions-section">
            <span className="section-label">ğŸ’¡ å›ç­”å»ºè®®:</span>
            <ul className="suggestions-list">
              {response.suggestions.map((suggestion, index) => (
                <li key={index}>{suggestion}</li>
              ))}
            </ul>
          </div>
        )}
      </div>
    </motion.div>
  );
};
```

### 3.5 æ§åˆ¶é¢æ¿ç»„ä»¶

```tsx
interface ControlPanelProps {
  isListening: boolean;
  isHidden: boolean;
  onToggleListening: () => void;
  onHide: () => void;
  onSettings: () => void;
  onKnowledgeBase: () => void;
}

const ControlPanel: React.FC<ControlPanelProps> = ({
  isListening,
  isHidden,
  onToggleListening,
  onHide,
  onSettings,
  onKnowledgeBase
}) => {
  return (
    <div className="control-panel">
      <div className="primary-controls">
        <button
          className={`control-btn primary ${isListening ? 'listening' : ''}`}
          onClick={onToggleListening}
        >
          <div className="btn-icon">
            {isListening ? <StopIcon size={16} /> : <MicIcon size={16} />}
          </div>
          <span>{isListening ? 'åœæ­¢ç›‘å¬' : 'å¼€å§‹ç›‘å¬'}</span>
        </button>
      </div>

      <div className="secondary-controls">
        <button
          className="control-btn secondary"
          onClick={onHide}
          title="éšè—åŠ©æ‰‹"
        >
          <EyeOffIcon size={16} />
        </button>

        <button
          className="control-btn secondary"
          onClick={onKnowledgeBase}
          title="çŸ¥è¯†åº“"
        >
          <BookIcon size={16} />
        </button>

        <button
          className="control-btn secondary"
          onClick={onSettings}
          title="è®¾ç½®"
        >
          <SettingsIcon size={16} />
        </button>
      </div>
    </div>
  );
};
```

## 4. äº¤äº’åŠ¨ç”»è®¾è®¡

### 4.1 åŠ¨ç”»é…ç½®

```css
/* å…¨å±€åŠ¨ç”»å˜é‡ */
:root {
  --animation-fast: 0.15s;
  --animation-normal: 0.3s;
  --animation-slow: 0.5s;
  --easing-smooth: cubic-bezier(0.4, 0, 0.2, 1);
  --easing-bounce: cubic-bezier(0.68, -0.55, 0.265, 1.55);
}

/* è„‰å†²åŠ¨ç”» */
@keyframes pulse {
  0% {
    transform: scale(1);
    opacity: 1;
  }
  50% {
    transform: scale(1.1);
    opacity: 0.8;
  }
  100% {
    transform: scale(1);
    opacity: 1;
  }
}

/* æ—‹è½¬åŠ¨ç”» */
@keyframes spin {
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
}

/* æ³¢æµªåŠ¨ç”» */
@keyframes wave {
  0%, 100% {
    height: 4px;
  }
  50% {
    height: 20px;
  }
}

/* é—ªçƒåŠ¨ç”» */
@keyframes blink {
  0%, 50% {
    opacity: 1;
  }
  51%, 100% {
    opacity: 0;
  }
}

/* åŠ è½½ç‚¹åŠ¨ç”» */
@keyframes loading-dots {
  0%, 20% {
    opacity: 0;
    transform: scale(0.8);
  }
  50% {
    opacity: 1;
    transform: scale(1);
  }
  100% {
    opacity: 0;
    transform: scale(0.8);
  }
}
```

### 4.2 çŠ¶æ€è½¬æ¢åŠ¨ç”»

```tsx
const AnimatedStatusTransition: React.FC<{
  status: string;
  children: React.ReactNode;
}> = ({ status, children }) => {
  return (
    <AnimatePresence mode="wait">
      <motion.div
        key={status}
        initial={{ opacity: 0, scale: 0.9 }}
        animate={{ opacity: 1, scale: 1 }}
        exit={{ opacity: 0, scale: 1.1 }}
        transition={{
          duration: 0.2,
          ease: "easeInOut"
        }}
      >
        {children}
      </motion.div>
    </AnimatePresence>
  );
};
```

### 4.3 æ‰‹åŠ¿äº¤äº’

```tsx
const GestureHandler: React.FC<{
  onSwipeUp: () => void;
  onSwipeDown: () => void;
  onDoubleClick: () => void;
  children: React.ReactNode;
}> = ({ onSwipeUp, onSwipeDown, onDoubleClick, children }) => {
  const [startY, setStartY] = useState(0);
  const [lastClickTime, setLastClickTime] = useState(0);

  const handleTouchStart = (e: React.TouchEvent) => {
    setStartY(e.touches[0].clientY);
  };

  const handleTouchEnd = (e: React.TouchEvent) => {
    const endY = e.changedTouches[0].clientY;
    const deltaY = startY - endY;

    if (Math.abs(deltaY) > 50) {
      if (deltaY > 0) {
        onSwipeUp();
      } else {
        onSwipeDown();
      }
    }
  };

  const handleClick = () => {
    const now = Date.now();
    if (now - lastClickTime < 300) {
      onDoubleClick();
    }
    setLastClickTime(now);
  };

  return (
    <div
      onTouchStart={handleTouchStart}
      onTouchEnd={handleTouchEnd}
      onClick={handleClick}
    >
      {children}
    </div>
  );
};
```

## 5. ä¸»é¢˜ç³»ç»Ÿ

### 5.1 ä¸»é¢˜å®šä¹‰

```typescript
interface Theme {
  name: string;
  colors: {
    primary: string;
    secondary: string;
    background: string;
    surface: string;
    text: {
      primary: string;
      secondary: string;
      disabled: string;
    };
    status: {
      success: string;
      warning: string;
      error: string;
      info: string;
    };
    border: string;
    shadow: string;
  };
  typography: {
    fontFamily: string;
    fontSize: {
      xs: string;
      sm: string;
      md: string;
      lg: string;
      xl: string;
    };
    fontWeight: {
      normal: number;
      medium: number;
      bold: number;
    };
  };
  spacing: {
    xs: string;
    sm: string;
    md: string;
    lg: string;
    xl: string;
  };
  borderRadius: {
    sm: string;
    md: string;
    lg: string;
    full: string;
  };
}

const darkTheme: Theme = {
  name: 'dark',
  colors: {
    primary: '#667eea',
    secondary: '#764ba2',
    background: 'rgba(0, 0, 0, 0.92)',
    surface: 'rgba(255, 255, 255, 0.05)',
    text: {
      primary: '#f3f4f6',
      secondary: '#d1d5db',
      disabled: '#6b7280'
    },
    status: {
      success: '#10b981',
      warning: '#f59e0b',
      error: '#ef4444',
      info: '#3b82f6'
    },
    border: 'rgba(255, 255, 255, 0.1)',
    shadow: 'rgba(0, 0, 0, 0.4)'
  },
  typography: {
    fontFamily: '-apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif',
    fontSize: {
      xs: '11px',
      sm: '12px',
      md: '14px',
      lg: '16px',
      xl: '18px'
    },
    fontWeight: {
      normal: 400,
      medium: 500,
      bold: 600
    }
  },
  spacing: {
    xs: '4px',
    sm: '8px',
    md: '12px',
    lg: '16px',
    xl: '20px'
  },
  borderRadius: {
    sm: '4px',
    md: '8px',
    lg: '12px',
    full: '50%'
  }
};

const lightTheme: Theme = {
  ...darkTheme,
  name: 'light',
  colors: {
    ...darkTheme.colors,
    background: 'rgba(255, 255, 255, 0.95)',
    surface: 'rgba(0, 0, 0, 0.05)',
    text: {
      primary: '#1f2937',
      secondary: '#4b5563',
      disabled: '#9ca3af'
    },
    border: 'rgba(0, 0, 0, 0.1)',
    shadow: 'rgba(0, 0, 0, 0.1)'
  }
};
```

### 5.2 ä¸»é¢˜æä¾›è€…

```tsx
const ThemeContext = React.createContext<{
  theme: Theme;
  toggleTheme: () => void;
}>({
  theme: darkTheme,
  toggleTheme: () => {}
});

export const ThemeProvider: React.FC<{
  children: React.ReactNode;
}> = ({ children }) => {
  const [currentTheme, setCurrentTheme] = useState<Theme>(darkTheme);

  const toggleTheme = () => {
    setCurrentTheme(prev =>
      prev.name === 'dark' ? lightTheme : darkTheme
    );
  };

  useEffect(() => {
    // åº”ç”¨CSSå˜é‡
    const root = document.documentElement;
    Object.entries(currentTheme.colors).forEach(([key, value]) => {
      if (typeof value === 'string') {
        root.style.setProperty(`--color-${key}`, value);
      } else {
        Object.entries(value).forEach(([subKey, subValue]) => {
          root.style.setProperty(`--color-${key}-${subKey}`, subValue);
        });
      }
    });
  }, [currentTheme]);

  return (
    <ThemeContext.Provider value={{ theme: currentTheme, toggleTheme }}>
      {children}
    </ThemeContext.Provider>
  );
};

export const useTheme = () => useContext(ThemeContext);
```

## 6. å“åº”å¼è®¾è®¡

### 6.1 æ–­ç‚¹ç³»ç»Ÿ

```css
/* å“åº”å¼æ–­ç‚¹ */
:root {
  --breakpoint-sm: 320px;
  --breakpoint-md: 380px;
  --breakpoint-lg: 450px;
}

/* å°å±å¹•é€‚é… */
@media (max-width: 320px) {
  .app-container {
    width: 100vw;
    height: 100vh;
    border-radius: 0;
  }

  .question-display,
  .answer-panel {
    font-size: 12px;
    padding: 12px;
  }

  .control-panel {
    flex-direction: column;
    gap: 8px;
  }
}

/* ä¸­ç­‰å±å¹•é€‚é… */
@media (min-width: 321px) and (max-width: 450px) {
  .app-container {
    width: 90vw;
    max-width: 380px;
  }
}

/* å¤§å±å¹•é€‚é… */
@media (min-width: 451px) {
  .app-container {
    width: 450px;
  }

  .answer-panel {
    max-height: 400px;
  }
}
```

### 6.2 è‡ªé€‚åº”å¸ƒå±€

```tsx
const ResponsiveLayout: React.FC<{
  children: React.ReactNode;
}> = ({ children }) => {
  const [windowSize, setWindowSize] = useState({
    width: window.innerWidth,
    height: window.innerHeight
  });

  useEffect(() => {
    const handleResize = () => {
      setWindowSize({
        width: window.innerWidth,
        height: window.innerHeight
      });
    };

    window.addEventListener('resize', handleResize);
    return () => window.removeEventListener('resize', handleResize);
  }, []);

  const getLayoutClass = () => {
    if (windowSize.width < 321) return 'layout-sm';
    if (windowSize.width < 451) return 'layout-md';
    return 'layout-lg';
  };

  return (
    <div className={`responsive-layout ${getLayoutClass()}`}>
      {children}
    </div>
  );
};
```

## 7. æ— éšœç¢è®¾è®¡

### 7.1 é”®ç›˜å¯¼èˆª

```tsx
const KeyboardNavigation: React.FC = () => {
  useEffect(() => {
    const handleKeyDown = (e: KeyboardEvent) => {
      // Tab é”®å¯¼èˆª
      if (e.key === 'Tab') {
        const focusableElements = document.querySelectorAll(
          'button, input, select, textarea, [tabindex]:not([tabindex="-1"])'
        );

        const firstElement = focusableElements[0] as HTMLElement;
        const lastElement = focusableElements[focusableElements.length - 1] as HTMLElement;

        if (e.shiftKey && document.activeElement === firstElement) {
          e.preventDefault();
          lastElement.focus();
        } else if (!e.shiftKey && document.activeElement === lastElement) {
          e.preventDefault();
          firstElement.focus();
        }
      }

      // å¿«æ·é”®
      if (e.ctrlKey || e.metaKey) {
        switch (e.key) {
          case 'h':
            e.preventDefault();
            // éšè—/æ˜¾ç¤ºçª—å£
            break;
          case 'l':
            e.preventDefault();
            // å¼€å§‹/åœæ­¢ç›‘å¬
            break;
          case 'c':
            e.preventDefault();
            // å¤åˆ¶å›ç­”
            break;
        }
      }

      // ESC é”®å…³é—­é¢æ¿
      if (e.key === 'Escape') {
        // å…³é—­å½“å‰æ‰“å¼€çš„é¢æ¿
      }
    };

    document.addEventListener('keydown', handleKeyDown);
    return () => document.removeEventListener('keydown', handleKeyDown);
  }, []);

  return null;
};
```

### 7.2 å±å¹•é˜…è¯»å™¨æ”¯æŒ

```tsx
const AccessibleButton: React.FC<{
  children: React.ReactNode;
  onClick: () => void;
  ariaLabel: string;
  disabled?: boolean;
}> = ({ children, onClick, ariaLabel, disabled = false }) => {
  return (
    <button
      onClick={onClick}
      disabled={disabled}
      aria-label={ariaLabel}
      aria-disabled={disabled}
      role="button"
      tabIndex={disabled ? -1 : 0}
    >
      {children}
    </button>
  );
};

const AccessibleStatus: React.FC<{
  status: string;
  isLive?: boolean;
}> = ({ status, isLive = true }) => {
  return (
    <div
      role="status"
      aria-live={isLive ? "polite" : "off"}
      aria-atomic="true"
    >
      {status}
    </div>
  );
};
```

## 8. æ€§èƒ½ä¼˜åŒ–

### 8.1 ç»„ä»¶æ‡’åŠ è½½

```tsx
const LazyAnswerPanel = React.lazy(() => import('./AnswerPanel'));
const LazySettingsPanel = React.lazy(() => import('./SettingsPanel'));
const LazyKnowledgeBase = React.lazy(() => import('./KnowledgeBase'));

const App: React.FC = () => {
  return (
    <Suspense fallback={<LoadingSpinner />}>
      <Router>
        <Routes>
          <Route path="/" element={<MainPanel />} />
          <Route path="/settings" element={<LazySettingsPanel />} />
          <Route path="/knowledge" element={<LazyKnowledgeBase />} />
        </Routes>
      </Router>
    </Suspense>
  );
};
```

### 8.2 è™šæ‹ŸåŒ–é•¿åˆ—è¡¨

```tsx
const VirtualizedKnowledgeList: React.FC<{
  items: KnowledgeItem[];
}> = ({ items }) => {
  const containerRef = useRef<HTMLDivElement>(null);
  const [visibleRange, setVisibleRange] = useState({ start: 0, end: 10 });

  const itemHeight = 60;
  const containerHeight = 300;

  useEffect(() => {
    const container = containerRef.current;
    if (!container) return;

    const handleScroll = () => {
      const scrollTop = container.scrollTop;
      const start = Math.floor(scrollTop / itemHeight);
      const end = Math.min(
        start + Math.ceil(containerHeight / itemHeight) + 2,
        items.length
      );

      setVisibleRange({ start, end });
    };

    container.addEventListener('scroll', handleScroll);
    return () => container.removeEventListener('scroll', handleScroll);
  }, [items.length]);

  const visibleItems = items.slice(visibleRange.start, visibleRange.end);
  const totalHeight = items.length * itemHeight;
  const offsetY = visibleRange.start * itemHeight;

  return (
    <div
      ref={containerRef}
      className="virtualized-list"
      style={{ height: containerHeight, overflow: 'auto' }}
    >
      <div style={{ height: totalHeight, position: 'relative' }}>
        <div style={{ transform: `translateY(${offsetY}px)` }}>
          {visibleItems.map((item, index) => (
            <KnowledgeItem
              key={item.id}
              item={item}
              style={{ height: itemHeight }}
            />
          ))}
        </div>
      </div>
    </div>
  );
};
```

## 9. æ ·å¼ç³»ç»Ÿ

### 9.1 å®Œæ•´æ ·å¼å®šä¹‰

```css
/* å…¨å±€æ ·å¼é‡ç½® */
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

body {
  font-family: var(--font-family);
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

/* åº”ç”¨å®¹å™¨ */
.app-container {
  width: 380px;
  min-height: 450px;
  background: var(--color-background);
  border-radius: var(--border-radius-lg);
  border: 1px solid var(--color-border);
  backdrop-filter: blur(20px);
  box-shadow:
    0 20px 40px var(--color-shadow),
    0 0 0 1px rgba(255, 255, 255, 0.05);
  overflow: hidden;
  font-family: var(--font-family);
  user-select: none;
  -webkit-user-select: none;
}

/* æ ‡é¢˜æ  */
.title-bar {
  -webkit-app-region: drag;
  height: 40px;
  background: linear-gradient(135deg, var(--color-primary), var(--color-secondary));
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 0 var(--spacing-lg);
  color: white;
}

.title-content {
  display: flex;
  align-items: center;
  gap: var(--spacing-sm);
}

.app-icon {
  font-size: 16px;
}

.app-title {
  font-size: var(--font-size-md);
  font-weight: var(--font-weight-medium);
}

.window-controls {
  -webkit-app-region: no-drag;
  display: flex;
  gap: var(--spacing-sm);
}

.control-btn {
  width: 20px;
  height: 20px;
  border-radius: var(--border-radius-full);
  border: none;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all var(--animation-fast) var(--easing-smooth);
  background: rgba(255, 255, 255, 0.2);
  color: white;
}

.control-btn:hover {
  background: rgba(255, 255, 255, 0.3);
  transform: scale(1.1);
}

.control-btn.minimize {
  background: #ffbd2e;
}

.control-btn.close {
  background: #ff5f57;
}

/* å†…å®¹åŒºåŸŸ */
.content-area {
  padding: var(--spacing-lg);
  height: calc(100% - 40px);
  overflow-y: auto;
  display: flex;
  flex-direction: column;
  gap: var(--spacing-lg);
}

/* çŠ¶æ€æŒ‡ç¤ºå™¨ */
.status-indicator {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: var(--spacing-md);
  background: var(--color-surface);
  border-radius: var(--border-radius-md);
  border: 1px solid var(--color-border);
}

.status-main {
  display: flex;
  align-items: center;
  gap: var(--spacing-md);
}

.status-dot {
  position: relative;
  width: 12px;
  height: 12px;
  border-radius: var(--border-radius-full);
  transition: all var(--animation-normal) var(--easing-smooth);
}

.status-dot.pulse {
  animation: pulse 2s infinite;
}

.status-dot.spin {
  animation: spin 1s linear infinite;
}

.pulse-ring {
  position: absolute;
  top: -4px;
  left: -4px;
  right: -4px;
  bottom: -4px;
  border-radius: var(--border-radius-full);
  background: currentColor;
  opacity: 0.3;
  animation: pulse 2s infinite;
}

.status-info {
  display: flex;
  flex-direction: column;
  gap: var(--spacing-xs);
}

.status-text {
  color: var(--color-text-primary);
  font-size: var(--font-size-md);
  font-weight: var(--font-weight-medium);
}

.confidence-indicator {
  display: flex;
  flex-direction: column;
  gap: var(--spacing-xs);
}

.confidence-text {
  color: var(--color-text-secondary);
  font-size: var(--font-size-sm);
}

.confidence-bar {
  width: 60px;
  height: 4px;
  background: rgba(255, 255, 255, 0.1);
  border-radius: var(--border-radius-sm);
  overflow: hidden;
}

.confidence-fill {
  height: 100%;
  background: linear-gradient(90deg, var(--color-status-success), var(--color-status-warning));
  transition: width var(--animation-normal) var(--easing-smooth);
}

.connection-status {
  display: flex;
  align-items: center;
  gap: var(--spacing-xs);
}

.connection-dot {
  width: 8px;
  height: 8px;
  border-radius: var(--border-radius-full);
  background: var(--color-status-error);
  transition: all var(--animation-fast) var(--easing-smooth);
}

.connection-dot.online {
  background: var(--color-status-success);
}

.connection-text {
  color: var(--color-text-secondary);
  font-size: var(--font-size-xs);
}

/* é—®é¢˜æ˜¾ç¤ºåŒºåŸŸ */
.question-display {
  background: var(--color-surface);
  border-radius: var(--border-radius-md);
  border: 1px solid var(--color-border);
  border-left: 4px solid var(--color-primary);
  overflow: hidden;
}

.question-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: var(--spacing-md) var(--spacing-lg);
  background: rgba(255, 255, 255, 0.02);
  border-bottom: 1px solid var(--color-border);
}

.question-header h3 {
  color: var(--color-text-primary);
  font-size: var(--font-size-md);
  font-weight: var(--font-weight-medium);
  margin: 0;
}

.question-actions {
  display: flex;
  gap: var(--spacing-xs);
}

.action-btn {
  width: 24px;
  height: 24px;
  border: none;
  background: rgba(255, 255, 255, 0.1);
  color: var(--color-text-secondary);
  border-radius: var(--border-radius-sm);
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all var(--animation-fast) var(--easing-smooth);
}

.action-btn:hover {
  background: rgba(255, 255, 255, 0.2);
  color: var(--color-text-primary);
  transform: scale(1.1);
}

.question-content {
  padding: var(--spacing-lg);
  min-height: 60px;
  display: flex;
  align-items: center;
}

.question-text {
  color: var(--color-text-primary);
  font-size: var(--font-size-md);
  line-height: 1.5;
  width: 100%;
}

.question-text.listening {
  color: var(--color-status-info);
  font-style: italic;
}

.question-text.placeholder {
  color: var(--color-text-disabled);
  text-align: center;
}

.cursor-blink {
  animation: blink 1s infinite;
  color: var(--color-primary);
}

.audio-visualizer {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 2px;
  margin-top: var(--spacing-md);
  height: 24px;
}

.wave-bar {
  width: 3px;
  height: 4px;
  background: var(--color-primary);
  border-radius: var(--border-radius-sm);
  animation: wave 1.5s ease-in-out infinite;
}

/* ç­”æ¡ˆé¢æ¿ */
.answer-panel {
  background: var(--color-surface);
  border-radius: var(--border-radius-lg);
  border: 1px solid var(--color-border);
  overflow: hidden;
  box-shadow: 0 8px 24px rgba(0, 0, 0, 0.2);
}

.answer-panel.loading {
  padding: var(--spacing-xl);
  text-align: center;
}

.loading-header {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: var(--spacing-md);
  margin-bottom: var(--spacing-lg);
}

.loading-icon {
  font-size: 24px;
  animation: spin 2s linear infinite;
}

.loading-animation {
  display: flex;
  justify-content: center;
}

.loading-dots {
  display: flex;
  gap: var(--spacing-xs);
}

.loading-dots span {
  width: 8px;
  height: 8px;
  background: var(--color-primary);
  border-radius: var(--border-radius-full);
  animation: loading-dots 1.4s ease-in-out infinite both;
}

.loading-dots span:nth-child(1) { animation-delay: -0.32s; }
.loading-dots span:nth-child(2) { animation-delay: -0.16s; }
.loading-dots span:nth-child(3) { animation-delay: 0s; }

.answer-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: var(--spacing-lg);
  background: rgba(255, 255, 255, 0.02);
  border-bottom: 1px solid var(--color-border);
}

.answer-title {
  display: flex;
  align-items: center;
  gap: var(--spacing-md);
}

.answer-title h3 {
  color: var(--color-text-primary);
  font-size: var(--font-size-md);
  font-weight: var(--font-weight-medium);
  margin: 0;
}

.confidence-badge {
  background: linear-gradient(135deg, var(--color-status-success), var(--color-status-warning));
  color: white;
  padding: var(--spacing-xs) var(--spacing-sm);
  border-radius: var(--border-radius-sm);
  font-size: var(--font-size-xs);
  font-weight: var(--font-weight-medium);
}

.answer-actions {
  display: flex;
  gap: var(--spacing-xs);
}

.answer-content {
  padding: var(--spacing-lg);
}

.answer-text {
  color: var(--color-text-primary);
  font-size: var(--font-size-md);
  line-height: 1.6;
  margin-bottom: var(--spacing-lg);
  padding: var(--spacing-md);
  background: rgba(0, 0, 0, 0.2);
  border-radius: var(--border-radius-md);
  border-left: 3px solid var(--color-primary);
}

.keywords-section,
.suggestions-section {
  margin-bottom: var(--spacing-lg);
}

.keywords-section:last-child,
.suggestions-section:last-child {
  margin-bottom: 0;
}

.section-label {
  color: var(--color-text-secondary);
  font-size: var(--font-size-sm);
  font-weight: var(--font-weight-medium);
  display: block;
  margin-bottom: var(--spacing-sm);
}

.keywords-list {
  display: flex;
  flex-wrap: wrap;
  gap: var(--spacing-xs);
}

.keyword-tag {
  background: rgba(102, 126, 234, 0.2);
  color: var(--color-primary);
  padding: var(--spacing-xs) var(--spacing-sm);
  border-radius: var(--border-radius-sm);
  font-size: var(--font-size-xs);
  font-weight: var(--font-weight-medium);
  border: 1px solid rgba(102, 126, 234, 0.3);
}

.suggestions-list {
  list-style: none;
  padding: 0;
  margin: 0;
}

.suggestions-list li {
  color: var(--color-text-secondary);
  font-size: var(--font-size-sm);
  line-height: 1.5;
  margin-bottom: var(--spacing-sm);
  padding-left: var(--spacing-lg);
  position: relative;
}

.suggestions-list li:before {
  content: "â€¢";
  color: var(--color-primary);
  position: absolute;
  left: 0;
  font-weight: bold;
}

.suggestions-list li:last-child {
  margin-bottom: 0;
}

/* æ§åˆ¶é¢æ¿ */
.control-panel {
  display: flex;
  flex-direction: column;
  gap: var(--spacing-md);
  margin-top: auto;
}

.primary-controls {
  display: flex;
}

.secondary-controls {
  display: flex;
  gap: var(--spacing-sm);
  justify-content: center;
}

.control-btn.primary {
  flex: 1;
  height: 48px;
  background: linear-gradient(135deg, var(--color-primary), var(--color-secondary));
  color: white;
  border: none;
  border-radius: var(--border-radius-md);
  font-size: var(--font-size-md);
  font-weight: var(--font-weight-medium);
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: var(--spacing-sm);
  transition: all var(--animation-normal) var(--easing-smooth);
  box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
}

.control-btn.primary:hover {
  transform: translateY(-2px);
  box-shadow: 0 6px 16px rgba(102, 126, 234, 0.4);
}

.control-btn.primary:active {
  transform: translateY(0);
  box-shadow: 0 2px 8px rgba(102, 126, 234, 0.3);
}

.control-btn.primary.listening {
  background: linear-gradient(135deg, var(--color-status-error), #dc2626);
}

.control-btn.primary.listening:hover {
  box-shadow: 0 6px 16px rgba(239, 68, 68, 0.4);
}

.btn-icon {
  display: flex;
  align-items: center;
  justify-content: center;
}

.control-btn.secondary {
  width: 40px;
  height: 40px;
  background: var(--color-surface);
  color: var(--color-text-secondary);
  border: 1px solid var(--color-border);
  border-radius: var(--border-radius-md);
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all var(--animation-fast) var(--easing-smooth);
}

.control-btn.secondary:hover {
  background: rgba(255, 255, 255, 0.1);
  color: var(--color-text-primary);
  border-color: var(--color-primary);
  transform: scale(1.05);
}

/* æ»šåŠ¨æ¡æ ·å¼ */
.content-area::-webkit-scrollbar {
  width: 6px;
}

.content-area::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: var(--border-radius-sm);
}

.content-area::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: var(--border-radius-sm);
}

.content-area::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* å·¥å…·æç¤º */
.tooltip {
  position: relative;
}

.tooltip:hover::after {
  content: attr(data-tooltip);
  position: absolute;
  bottom: 100%;
  left: 50%;
  transform: translateX(-50%);
  background: rgba(0, 0, 0, 0.9);
  color: white;
  padding: var(--spacing-xs) var(--spacing-sm);
  border-radius: var(--border-radius-sm);
  font-size: var(--font-size-xs);
  white-space: nowrap;
  z-index: 1000;
  margin-bottom: var(--spacing-xs);
}

.tooltip:hover::before {
  content: "";
  position: absolute;
  bottom: 100%;
  left: 50%;
  transform: translateX(-50%);
  border: 4px solid transparent;
  border-top-color: rgba(0, 0, 0, 0.9);
  z-index: 1000;
}

/* å“åº”å¼è°ƒæ•´ */
@media (max-width: 320px) {
  .answer-text {
    font-size: var(--font-size-sm);
    padding: var(--spacing-sm);
  }

  .control-btn.primary {
    height: 40px;
    font-size: var(--font-size-sm);
  }

  .keywords-list {
    gap: var(--spacing-xs);
  }

  .keyword-tag {
    font-size: 10px;
    padding: 2px var(--spacing-xs);
  }
}

/* æš—è‰²ä¸»é¢˜ç‰¹å®šæ ·å¼ */
[data-theme="dark"] {
  --color-background: rgba(0, 0, 0, 0.95);
  --color-surface: rgba(255, 255, 255, 0.05);
  --color-border: rgba(255, 255, 255, 0.1);
}

/* äº®è‰²ä¸»é¢˜ç‰¹å®šæ ·å¼ */
[data-theme="light"] {
  --color-background: rgba(255, 255, 255, 0.95);
  --color-surface: rgba(0, 0, 0, 0.05);
  --color-border: rgba(0, 0, 0, 0.1);
}

/* é«˜å¯¹æ¯”åº¦æ¨¡å¼ */
@media (prefers-contrast: high) {
  .app-container {
    border: 2px solid var(--color-primary);
  }

  .control-btn {
    border: 1px solid currentColor;
  }

  .question-text,
  .answer-text {
    font-weight: var(--font-weight-medium);
  }
}

/* å‡å°‘åŠ¨ç”»æ¨¡å¼ */
@media (prefers-reduced-motion: reduce) {
  * {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
  }

  .pulse-ring,
  .wave-bar,
  .loading-dots span {
    animation: none;
  }
}

/* æ‰“å°æ ·å¼ */
@media print {
  .app-container {
    background: white;
    color: black;
    box-shadow: none;
    border: 1px solid black;
  }

  .title-bar,
  .control-panel {
    display: none;
  }

  .answer-text {
    background: none;
    border: 1px solid black;
  }
}
```

## 10. äº¤äº’çŠ¶æ€ç®¡ç†

### 10.1 çŠ¶æ€å®šä¹‰

```typescript
interface AppState {
  ui: {
    isVisible: boolean;
    isMinimized: boolean;
    currentView: 'main' | 'settings' | 'knowledge';
    theme: 'dark' | 'light';
    opacity: number;
    position: { x: number; y: number };
  };
  speech: {
    isListening: boolean;
    currentQuestion: string;
    interimResult: string;
    isProcessing: boolean;
  };
  ai: {
    isAnalyzing: boolean;
    currentResponse: AIResponse | null;
    history: Array<{
      question: string;
      response: AIResponse;
      timestamp: Date;
    }>;
  };
  privacy: {
    isHidden: boolean;
    screenSharingDetected: boolean;
    autoHideEnabled: boolean;
  };
  system: {
    isOnline: boolean;
    lastError: string | null;
    performance: {
      memoryUsage: number;
      cpuUsage: number;
    };
  };
}
```

### 10.2 çŠ¶æ€ç®¡ç†å™¨

```typescript
import { create } from 'zustand';
import { subscribeWithSelector } from 'zustand/middleware';

interface AppStore extends AppState {
  // UI Actions
  setVisible: (visible: boolean) => void;
  setMinimized: (minimized: boolean) => void;
  setCurrentView: (view: AppState['ui']['currentView']) => void;
  setTheme: (theme: AppState['ui']['theme']) => void;
  setOpacity: (opacity: number) => void;
  setPosition: (position: { x: number; y: number }) => void;

  // Speech Actions
  startListening: () => void;
  stopListening: () => void;
  setCurrentQuestion: (question: string) => void;
  setInterimResult: (result: string) => void;
  setProcessing: (processing: boolean) => void;

  // AI Actions
  setAnalyzing: (analyzing: boolean) => void;
  setCurrentResponse: (response: AIResponse | null) => void;
  addToHistory: (question: string, response: AIResponse) => void;
  clearHistory: () => void;

  // Privacy Actions
  setHidden: (hidden: boolean) => void;
  setScreenSharingDetected: (detected: boolean) => void;
  setAutoHideEnabled: (enabled: boolean) => void;

  // System Actions
  setOnline: (online: boolean) => void;
  setLastError: (error: string | null) => void;
  updatePerformance: (performance: Partial<AppState['system']['performance']>) => void;
}

export const useAppStore = create<AppStore>()(
  subscribeWithSelector((set, get) => ({
    // Initial State
    ui: {
      isVisible: true,
      isMinimized: false,
      currentView: 'main',
      theme: 'dark',
      opacity: 0.9,
      position: { x: 100, y: 100 }
    },
    speech: {
      isListening: false,
      currentQuestion: '',
      interimResult: '',
      isProcessing: false
    },
    ai: {
      isAnalyzing: false,
      currentResponse: null,
      history: []
    },
    privacy: {
      isHidden: false,
      screenSharingDetected: false,
      autoHideEnabled: true
    },
    system: {
      isOnline: true,
      lastError: null,
      performance: {
        memoryUsage: 0,
        cpuUsage: 0
      }
    },

    // UI Actions
    setVisible: (visible) => set((state) => ({
      ui: { ...state.ui, isVisible: visible }
    })),

    setMinimized: (minimized) => set((state) => ({
      ui: { ...state.ui, isMinimized: minimized }
    })),

    setCurrentView: (view) => set((state) => ({
      ui: { ...state.ui, currentView: view }
    })),

    setTheme: (theme) => set((state) => ({
      ui: { ...state.ui, theme }
    })),

    setOpacity: (opacity) => set((state) => ({
      ui: { ...state.ui, opacity }
    })),

    setPosition: (position) => set((state) => ({
      ui: { ...state.ui, position }
    })),

    // Speech Actions
    startListening: () => set((state) => ({
      speech: { ...state.speech, isListening: true }
    })),

    stopListening: () => set((state) => ({
      speech: { ...state.speech, isListening: false, interimResult: '' }
    })),

    setCurrentQuestion: (currentQuestion) => set((state) => ({
      speech: { ...state.speech, currentQuestion }
    })),

    setInterimResult: (interimResult) => set((state) => ({
      speech: { ...state.speech, interimResult }
    })),

    setProcessing: (isProcessing) => set((state) => ({
      speech: { ...state.speech, isProcessing }
    })),

    // AI Actions
    setAnalyzing: (isAnalyzing) => set((state) => ({
      ai: { ...state.ai, isAnalyzing }
    })),

    setCurrentResponse: (currentResponse) => set((state) => ({
      ai: { ...state.ai, currentResponse }
    })),

    addToHistory: (question, response) => set((state) => ({
      ai: {
        ...state.ai,
        history: [
          ...state.ai.history,
          { question, response, timestamp: new Date() }
        ].slice(-50) // ä¿ç•™æœ€è¿‘50æ¡è®°å½•
      }
    })),

    clearHistory: () => set((state) => ({
      ai: { ...state.ai, history: [] }
    })),

    // Privacy Actions
    setHidden: (isHidden) => set((state) => ({
      privacy: { ...state.privacy, isHidden }
    })),

    setScreenSharingDetected: (screenSharingDetected) => set((state) => ({
      privacy: { ...state.privacy, screenSharingDetected }
    })),

    setAutoHideEnabled: (autoHideEnabled) => set((state) => ({
      privacy: { ...state.privacy, autoHideEnabled }
    })),

    // System Actions
    setOnline: (isOnline) => set((state) => ({
      system: { ...state.system, isOnline }
    })),

    setLastError: (lastError) => set((state) => ({
      system: { ...state.system, lastError }
    })),

    updatePerformance: (performance) => set((state) => ({
      system: {
        ...state.system,
        performance: { ...state.system.performance, ...performance }
      }
    }))
  }))
);

// çŠ¶æ€è®¢é˜…å™¨
export const useAppSubscriptions = () => {
  useEffect(() => {
    // ç›‘å¬éšç§çŠ¶æ€å˜åŒ–
    const unsubscribePrivacy = useAppStore.subscribe(
      (state) => state.privacy.screenSharingDetected,
      (detected) => {
        if (detected && useAppStore.getState().privacy.autoHideEnabled) {
          useAppStore.getState().setHidden(true);
        }
      }
    );

    // ç›‘å¬ä¸»é¢˜å˜åŒ–
    const unsubscribeTheme = useAppStore.subscribe(
      (state) => state.ui.theme,
      (theme) => {
        document.documentElement.setAttribute('data-theme', theme);
      }
    );

    // ç›‘å¬é”™è¯¯çŠ¶æ€
    const unsubscribeError = useAppStore.subscribe(
      (state) => state.system.lastError,
      (error) => {
        if (error) {
          console.error('åº”ç”¨é”™è¯¯:', error);
          // å¯ä»¥åœ¨è¿™é‡Œæ·»åŠ é”™è¯¯é€šçŸ¥é€»è¾‘
        }
      }
    );

    return () => {
      unsubscribePrivacy();
      unsubscribeTheme();
      unsubscribeError();
    };
  }, []);
};
```

## 11. æ€»ç»“

æœ¬æ¡Œé¢ç«¯ç•Œé¢äº¤äº’è®¾è®¡æ–‡æ¡£è¯¦ç»†æè¿°äº† OfferHelper æ¡Œé¢ç«¯åº”ç”¨çš„å®Œæ•´ç•Œé¢è®¾è®¡æ–¹æ¡ˆï¼ŒåŒ…æ‹¬ï¼š

### 11.1 è®¾è®¡ç‰¹è‰²
- **éšè”½æ€§è®¾è®¡**: ä¸“ä¸ºé¢è¯•åœºæ™¯ä¼˜åŒ–çš„ä½è°ƒç•Œé¢
- **é«˜æ•ˆäº¤äº’**: ä¸€é”®æ“ä½œï¼Œå¿«é€Ÿå“åº”çš„ç”¨æˆ·ä½“éªŒ
- **æ™ºèƒ½é€‚åº”**: æ ¹æ®ä½¿ç”¨åœºæ™¯è‡ªåŠ¨è°ƒæ•´ç•Œé¢çŠ¶æ€
- **æ— éšœç¢æ”¯æŒ**: å®Œæ•´çš„é”®ç›˜å¯¼èˆªå’Œå±å¹•é˜…è¯»å™¨æ”¯æŒ

### 11.2 æŠ€æœ¯å®ç°
- **React + TypeScript**: ç±»å‹å®‰å…¨çš„ç»„ä»¶å¼€å‘
- **Framer Motion**: æµç•…çš„åŠ¨ç”»æ•ˆæœ
- **Zustand**: è½»é‡çº§çŠ¶æ€ç®¡ç†
- **CSS Variables**: çµæ´»çš„ä¸»é¢˜ç³»ç»Ÿ

### 11.3 ç”¨æˆ·ä½“éªŒ
- **é›¶å­¦ä¹ æˆæœ¬**: ç›´è§‚çš„ç•Œé¢è®¾è®¡
- **æ¯«ç§’çº§å“åº”**: ä¼˜åŒ–çš„æ€§èƒ½è¡¨ç°
- **å¤šä¸»é¢˜æ”¯æŒ**: é€‚åº”ä¸åŒä½¿ç”¨ç¯å¢ƒ
- **å“åº”å¼å¸ƒå±€**: é€‚é…å„ç§å±å¹•å°ºå¯¸

è¯¥ç•Œé¢è®¾è®¡ç¡®ä¿äº†æ¡Œé¢ç«¯åº”ç”¨åœ¨æä¾›ä¸“ä¸šé¢è¯•è¾…åŠ©åŠŸèƒ½çš„åŒæ—¶ï¼Œä¿æŒæœ€ä½³çš„ç”¨æˆ·ä½“éªŒå’Œéšç§ä¿æŠ¤æ•ˆæœã€‚
# æ¡Œé¢ç«¯ç•Œé¢äº¤äº’è®¾è®¡

## 1. è®¾è®¡ç†å¿µ

### 1.1 è®¾è®¡åŸåˆ™

- **éšè”½æ€§ä¼˜å…ˆ**: ç•Œé¢è®¾è®¡ä»¥ä¸è¢«å‘ç°ä¸ºé¦–è¦ç›®æ ‡
- **æ•ˆç‡è‡³ä¸Š**: å¿«é€Ÿå“åº”ï¼Œä¸€é”®æ“ä½œ
- **ç®€æ´æ˜äº†**: ä¿¡æ¯å±‚æ¬¡æ¸…æ™°ï¼Œé¿å…å¹²æ‰°
- **æ™ºèƒ½é€‚åº”**: æ ¹æ®ä½¿ç”¨åœºæ™¯è‡ªåŠ¨è°ƒæ•´

### 1.2 ç”¨æˆ·ä½“éªŒç›®æ ‡

- é›¶å­¦ä¹ æˆæœ¬çš„ç›´è§‚æ“ä½œ
- æ¯«ç§’çº§çš„å“åº”é€Ÿåº¦
- æ— æ„ŸçŸ¥çš„éšç§ä¿æŠ¤
- ä¸“ä¸šçš„é¢è¯•è¾…åŠ©æ•ˆæœ

## 2. ç•Œé¢å¸ƒå±€è®¾è®¡

### 2.1 ä¸»ç•Œé¢ç»“æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ”µ OfferHelper              â”€  Ã—   â”‚ â† æ ‡é¢˜æ  (40px)
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸŸ¢ æ­£åœ¨ç›‘å¬...                      â”‚ â† çŠ¶æ€æ  (50px)
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ“ é¢è¯•å®˜é—®é¢˜                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ è¯·ä»‹ç»ä¸€ä¸‹ä½ çš„é¡¹ç›®ç»éªŒ...        â”‚ â”‚ â† é—®é¢˜æ˜¾ç¤ºåŒº (100px)
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ’¡ å»ºè®®å›ç­”                 ç½®ä¿¡åº¦85% â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ æˆ‘åœ¨ä¹‹å‰çš„å·¥ä½œä¸­ä¸»è¦è´Ÿè´£...      â”‚ â”‚
â”‚  â”‚                                 â”‚ â”‚ â† ç­”æ¡ˆæ˜¾ç¤ºåŒº (200px)
â”‚  â”‚ å…³é”®è¯: React, Node.js, é¡¹ç›®ç®¡ç† â”‚ â”‚
â”‚  â”‚                                 â”‚ â”‚
â”‚  â”‚ ğŸ’¡ å›ç­”å»ºè®®:                    â”‚ â”‚
â”‚  â”‚ â€¢ ç»“åˆå…·ä½“é¡¹ç›®æ¡ˆä¾‹              â”‚ â”‚
â”‚  â”‚ â€¢ çªå‡ºæŠ€æœ¯éš¾ç‚¹å’Œè§£å†³æ–¹æ¡ˆ        â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  [ğŸ¤ å¼€å§‹ç›‘å¬]  [ğŸ‘ éšè—åŠ©æ‰‹]        â”‚ â† æ§åˆ¶é¢æ¿ (60px)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
æ€»é«˜åº¦: 450px, å®½åº¦: 380px
```

### 2.2 å“åº”å¼å¸ƒå±€

```css
/* åŸºç¡€å¸ƒå±€ */
.app-container {
  width: 380px;
  min-height: 450px;
  max-height: 80vh;
  background: rgba(0, 0, 0, 0.92);
  border-radius: 16px;
  border: 1px solid rgba(255, 255, 255, 0.1);
  backdrop-filter: blur(20px);
  box-shadow:
    0 20px 40px rgba(0, 0, 0, 0.4),
    0 0 0 1px rgba(255, 255, 255, 0.05);
  overflow: hidden;
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
}

/* ç´§å‡‘æ¨¡å¼ */
.app-container.compact {
  width: 320px;
  min-height: 200px;
}

/* å±•å¼€æ¨¡å¼ */
.app-container.expanded {
  width: 450px;
  max-height: 90vh;
}

/* è¿·ä½ æ¨¡å¼ */
.app-container.mini {
  width: 60px;
  height: 60px;
  border-radius: 50%;
}
```

## 3. ç»„ä»¶è®¾è®¡è§„èŒƒ

### 3.1 æ ‡é¢˜æ ç»„ä»¶

```tsx
interface TitleBarProps {
  title: string;
  onMinimize: () => void;
  onClose: () => void;
  onDoubleClick: () => void;
}

const TitleBar: React.FC<TitleBarProps> = ({
  title,
  onMinimize,
  onClose,
  onDoubleClick
}) => {
  return (
    <div
      className="title-bar"
      onDoubleClick={onDoubleClick}
    >
      <div className="title-content">
        <div className="app-icon">ğŸ¯</div>
        <span className="app-title">{title}</span>
      </div>

      <div className="window-controls">
        <button
          className="control-btn minimize"
          onClick={onMinimize}
          title="æœ€å°åŒ–"
        >
          <MinusIcon size={12} />
        </button>
        <button
          className="control-btn close"
          onClick={onClose}
          title="éšè—"
        >
          <XIcon size={12} />
        </button>
      </div>
    </div>
  );
};
```

### 3.2 çŠ¶æ€æŒ‡ç¤ºå™¨ç»„ä»¶

```tsx
interface StatusIndicatorProps {
  status: 'idle' | 'listening' | 'analyzing' | 'hidden';
  confidence?: number;
  isOnline: boolean;
}

const StatusIndicator: React.FC<StatusIndicatorProps> = ({
  status,
  confidence,
  isOnline
}) => {
  const getStatusConfig = () => {
    switch (status) {
      case 'listening':
        return {
          color: '#10b981',
          icon: 'ğŸ¤',
          text: 'æ­£åœ¨ç›‘å¬...',
          animation: 'pulse'
        };
      case 'analyzing':
        return {
          color: '#f
