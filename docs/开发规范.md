# AIé¢è¯•åŠ©æ‰‹æ¡Œé¢ç«¯å¼€å‘è§„èŒƒ

## 1. ä»£ç è§„èŒƒ

### 1.1 TypeScript ç¼–ç è§„èŒƒ

#### 1.1.1 å‘½åè§„èŒƒ

```typescript
// âœ… æ­£ç¡®çš„å‘½åæ–¹å¼
// å˜é‡å’Œå‡½æ•°ä½¿ç”¨ camelCase
const userName = 'john';
const getUserInfo = () => {};

// ç±»åä½¿ç”¨ PascalCase
class VoiceRecognitionService {}

// æ¥å£ä½¿ç”¨ PascalCase
interface UserSettings {}

// ç±»å‹åˆ«åä½¿ç”¨ PascalCase
type ResponseMode = 'simple' | 'normal' | 'detailed';

// æšä¸¾ä½¿ç”¨ PascalCase
enum WindowState {
  MINIMIZED = 'minimized',
  HIDDEN = 'hidden',
  VISIBLE = 'visible'
}

// å¸¸é‡ä½¿ç”¨ SCREAMING_SNAKE_CASE
const MAX_RETRY_COUNT = 3;
const API_BASE_URL = 'https://api.example.com';

// æ–‡ä»¶åä½¿ç”¨ kebab-case
// voice-recorder.component.tsx
// user-settings.service.ts
// api-client.utils.ts

// ç›®å½•åä½¿ç”¨ kebab-case
// voice-recognition/
// user-settings/
// api-services/
```

#### 1.1.2 ç±»å‹å®šä¹‰è§„èŒƒ

```typescript
// âœ… æ¨èçš„ç±»å‹å®šä¹‰æ–¹å¼
// ä½¿ç”¨æ¥å£å®šä¹‰å¯¹è±¡ç±»å‹
interface VoiceSettings {
  readonly deviceId: string;
  sensitivity: number;
  noiseReduction: boolean;
  autoStart?: boolean; // å¯é€‰å±æ€§ä½¿ç”¨ ?
}

// ä½¿ç”¨ç±»å‹åˆ«åå®šä¹‰è”åˆç±»å‹
type Theme = 'light' | 'dark' | 'auto';
type Status = 'idle' | 'loading' | 'success' | 'error';

// æ³›å‹ä½¿ç”¨æœ‰æ„ä¹‰çš„åç§°
interface ApiResponse<TData = unknown> {
  data: TData;
  message: string;
  code: number;
}

// å‡½æ•°ç±»å‹å®šä¹‰
type EventHandler<T = Event> = (event: T) => void;
type AsyncFunction<T, R> = (param: T) => Promise<R>;

// âŒ é¿å…çš„å†™æ³•
// ä¸è¦ä½¿ç”¨ any
const data: any = {}; // åº”è¯¥å®šä¹‰å…·ä½“ç±»å‹

// ä¸è¦ä½¿ç”¨ Function ç±»å‹
const callback: Function = () => {}; // åº”è¯¥å®šä¹‰å…·ä½“çš„å‡½æ•°ç­¾å
```

#### 1.1.3 å‡½æ•°å®šä¹‰è§„èŒƒ

```typescript
// âœ… æ¨èçš„å‡½æ•°å®šä¹‰æ–¹å¼
// ä½¿ç”¨ç®­å¤´å‡½æ•°å®šä¹‰ç®€å•å‡½æ•°
const calculateVolume = (input: number): number => {
  return Math.max(0, Math.min(100, input));
};

// ä½¿ç”¨ async/await å¤„ç†å¼‚æ­¥æ“ä½œ
const fetchUserData = async (userId: string): Promise<User> => {
  try {
    const response = await apiClient.get(`/users/${userId}`);
    return response.data;
  } catch (error) {
    logger.error('è·å–ç”¨æˆ·æ•°æ®å¤±è´¥:', error);
    throw new Error('ç”¨æˆ·æ•°æ®è·å–å¤±è´¥');
  }
};

// ä½¿ç”¨å‡½æ•°é‡è½½å®šä¹‰å¤šç§è°ƒç”¨æ–¹å¼
function processVoiceInput(text: string): string;
function processVoiceInput(audio: ArrayBuffer): Promise<string>;
function processVoiceInput(input: string | ArrayBuffer): string | Promise<string> {
  if (typeof input === 'string') {
    return input.trim();
  }
  return processAudioBuffer(input);
}

// ä½¿ç”¨æ³›å‹çº¦æŸ
const createService = <T extends BaseService>(
  ServiceClass: new () => T
): T => {
  return new ServiceClass();
};
```

### 1.2 React ç»„ä»¶è§„èŒƒ

#### 1.2.1 ç»„ä»¶å®šä¹‰è§„èŒƒ

```typescript
// âœ… æ¨èçš„ç»„ä»¶å®šä¹‰æ–¹å¼
import React, { useState, useEffect, useCallback } from 'react';
import { VoiceRecorderProps } from './VoiceRecorder.types';
import { Container, Button } from './VoiceRecorder.styled';

export const VoiceRecorder: React.FC<VoiceRecorderProps> = ({
  onStart,
  onStop,
  onResult,
  disabled = false,
  className
}) => {
  // çŠ¶æ€å®šä¹‰
  const [isRecording, setIsRecording] = useState(false);
  const [volume, setVolume] = useState(0);

  // å‰¯ä½œç”¨å¤„ç†
  useEffect(() => {
    if (isRecording) {
      startVoiceRecognition();
    } else {
      stopVoiceRecognition();
    }

    return () => {
      cleanup();
    };
  }, [isRecording]);

  // äº‹ä»¶å¤„ç†å‡½æ•°
  const handleStartRecording = useCallback(() => {
    if (disabled) return;
    setIsRecording(true);
    onStart?.();
  }, [disabled, onStart]);

  const handleStopRecording = useCallback(() => {
    setIsRecording(false);
    onStop?.();
  }, [onStop]);

  // æ¸²æŸ“
  return (
    <Container className={className}>
      <Button
        onClick={isRecording ? handleStopRecording : handleStartRecording}
        disabled={disabled}
        $isRecording={isRecording}
      >
        {isRecording ? 'åœæ­¢' : 'å¼€å§‹'}
      </Button>
    </Container>
  );
};

// é»˜è®¤å¯¼å‡º
export default VoiceRecorder;
```

#### 1.2.2 Props ç±»å‹å®šä¹‰

```typescript
// VoiceRecorder.types.ts
export interface VoiceRecorderProps {
  // å¿…éœ€å±æ€§
  onStart: () => void;
  onStop: () => void;
  onResult: (text: string) => void;

  // å¯é€‰å±æ€§
  disabled?: boolean;
  className?: string;
  autoStart?: boolean;

  // é…ç½®å¯¹è±¡
  settings?: {
    sensitivity: number;
    noiseReduction: boolean;
  };

  // å­ç»„ä»¶
  children?: React.ReactNode;
}

// é»˜è®¤å±æ€§
export const defaultVoiceRecorderProps: Partial<VoiceRecorderProps> = {
  disabled: false,
  autoStart: false,
  settings: {
    sensitivity: 5,
    noiseReduction: true,
  },
};
```

#### 1.2.3 è‡ªå®šä¹‰ Hook è§„èŒƒ

```typescript
// useVoiceRecognition.ts
import { useState, useEffect, useCallback, useRef } from 'react';

interface UseVoiceRecognitionOptions {
  autoStart?: boolean;
  sensitivity?: number;
  onResult?: (text: string) => void;
  onError?: (error: Error) => void;
}

interface UseVoiceRecognitionReturn {
  isRecording: boolean;
  volume: number;
  lastResult: string;
  startRecording: () => void;
  stopRecording: () => void;
  clearResult: () => void;
}

export const useVoiceRecognition = (
  options: UseVoiceRecognitionOptions = {}
): UseVoiceRecognitionReturn => {
  const {
    autoStart = false,
    sensitivity = 5,
    onResult,
    onError
  } = options;

  // çŠ¶æ€ç®¡ç†
  const [isRecording, setIsRecording] = useState(false);
  const [volume, setVolume] = useState(0);
  const [lastResult, setLastResult] = useState('');

  // å¼•ç”¨ç®¡ç†
  const recognitionRef = useRef<SpeechRecognition | null>(null);
  const streamRef = useRef<MediaStream | null>(null);

  // å¼€å§‹å½•éŸ³
  const startRecording = useCallback(async () => {
    try {
      const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
      streamRef.current = stream;
      setIsRecording(true);

      // åˆå§‹åŒ–è¯­éŸ³è¯†åˆ«
      initializeSpeechRecognition();
    } catch (error) {
      onError?.(error as Error);
    }
  }, [onError]);

  // åœæ­¢å½•éŸ³
  const stopRecording = useCallback(() => {
    if (streamRef.current) {
      streamRef.current.getTracks().forEach(track => track.stop());
      streamRef.current = null;
    }

    if (recognitionRef.current) {
      recognitionRef.current.stop();
    }

    setIsRecording(false);
    setVolume(0);
  }, []);

  // æ¸…é™¤ç»“æœ
  const clearResult = useCallback(() => {
    setLastResult('');
  }, []);

  // åˆå§‹åŒ–è¯­éŸ³è¯†åˆ«
  const initializeSpeechRecognition = useCallback(() => {
    // å®ç°è¯­éŸ³è¯†åˆ«é€»è¾‘
  }, [sensitivity, onResult]);

  // è‡ªåŠ¨å¼€å§‹
  useEffect(() => {
    if (autoStart) {
      startRecording();
    }

    return () => {
      stopRecording();
    };
  }, [autoStart, startRecording, stopRecording]);

  return {
    isRecording,
    volume,
    lastResult,
    startRecording,
    stopRecording,
    clearResult,
  };
};
```

### 1.3 æ ·å¼è§„èŒƒ

#### 1.3.1 Styled Components è§„èŒƒ

```typescript
// VoiceRecorder.styled.ts
import styled, { css, keyframes } from 'styled-components';

// åŠ¨ç”»å®šä¹‰
const pulseAnimation = keyframes`
  0% { transform: scale(1); opacity: 1; }
  50% { transform: scale(1.05); opacity: 0.8; }
  100% { transform: scale(1); opacity: 1; }
`;

// åŸºç¡€å®¹å™¨
export const Container = styled.div`
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 16px;
  padding: 20px;
  background: var(--primary-bg);
  border-radius: 12px;
  border: 1px solid var(--border-color);
`;

// æŒ‰é’®ç»„ä»¶ï¼Œä½¿ç”¨ $ å‰ç¼€æ ‡è¯† transient props
export const Button = styled.button<{
  $isRecording?: boolean;
  $disabled?: boolean;
}>`
  width: 60px;
  height: 60px;
  border-radius: 50%;
  border: none;
  background: var(--accent-color);
  color: white;
  font-size: 24px;
  cursor: pointer;
  transition: all 0.2s ease;

  ${({ $isRecording }) =>
    $isRecording &&
    css`
      background: var(--error-color);
      animation: ${pulseAnimation} 1.5s infinite;
    `}

  ${({ $disabled }) =>
    $disabled &&
    css`
      opacity: 0.5;
      cursor: not-allowed;
      pointer-events: none;
    `}

  &:hover:not(:disabled) {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
  }

  &:active {
    transform: translateY(0);
  }
`;

// çŠ¶æ€æŒ‡ç¤ºå™¨
export const StatusIndicator = styled.div<{ $isActive: boolean }>`
  padding: 8px 16px;
  border-radius: 20px;
  font-size: 14px;
  font-weight: 500;
  transition: all 0.2s ease;

  ${({ $isActive }) =>
    $isActive
      ? css`
          background: var(--success-color);
          color: white;
        `
      : css`
          background: var(--secondary-bg);
          color: var(--text-secondary);
        `}
`;
```

#### 1.3.2 CSS å˜é‡è§„èŒƒ

```css
/* styles/variables.css */
:root {
  /* é¢œè‰²ç³»ç»Ÿ */
  --primary-bg: #1a1a1a;
  --secondary-bg: #2d2d2d;
  --accent-color: #007acc;
  --text-primary: #ffffff;
  --text-secondary: #b3b3b3;
  --border-color: #404040;

  /* çŠ¶æ€é¢œè‰² */
  --success-color: #52c41a;
  --warning-color: #faad14;
  --error-color: #ff4d4f;
  --info-color: #1890ff;

  /* é—´è·ç³»ç»Ÿ */
  --spacing-xs: 4px;
  --spacing-sm: 8px;
  --spacing-md: 16px;
  --spacing-lg: 24px;
  --spacing-xl: 32px;

  /* å­—ä½“ç³»ç»Ÿ */
  --font-size-xs: 12px;
  --font-size-sm: 14px;
  --font-size-md: 16px;
  --font-size-lg: 18px;
  --font-size-xl: 20px;

  /* åœ†è§’ç³»ç»Ÿ */
  --border-radius-sm: 4px;
  --border-radius-md: 8px;
  --border-radius-lg: 12px;
  --border-radius-xl: 16px;

  /* é˜´å½±ç³»ç»Ÿ */
  --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.1);
  --shadow-md: 0 4px 6px rgba(0, 0, 0, 0.1);
  --shadow-lg: 0 10px 15px rgba(0, 0, 0, 0.1);

  /* è¿‡æ¸¡åŠ¨ç”» */
  --transition-fast: 0.15s ease;
  --transition-normal: 0.2s ease;
  --transition-slow: 0.3s ease;
}
```

## 2. é¡¹ç›®ç»“æ„è§„èŒƒ

### 2.1 æ–‡ä»¶ç»„ç»‡è§„èŒƒ

```
src/renderer/components/
â”œâ”€â”€ common/                    # é€šç”¨ç»„ä»¶
â”‚   â”œâ”€â”€ Button/
â”‚   â”‚   â”œâ”€â”€ index.tsx         # ä¸»æ–‡ä»¶
â”‚   â”‚   â”œâ”€â”€ Button.types.ts   # ç±»å‹å®šä¹‰
â”‚   â”‚   â”œâ”€â”€ Button.styled.ts  # æ ·å¼æ–‡ä»¶
â”‚   â”‚   â”œâ”€â”€ Button.test.tsx   # æµ‹è¯•æ–‡ä»¶
â”‚   â”‚   â””â”€â”€ Button.stories.tsx # Storybook æ–‡ä»¶
â”‚   â””â”€â”€ ...
â”œâ”€â”€ layout/                    # å¸ƒå±€ç»„ä»¶
â”œâ”€â”€ business/                  # ä¸šåŠ¡ç»„ä»¶
â””â”€â”€ pages/                     # é¡µé¢ç»„ä»¶
```

### 2.2 å¯¼å…¥å¯¼å‡ºè§„èŒƒ

```typescript
// âœ… æ¨èçš„å¯¼å…¥æ–¹å¼
// ç¬¬ä¸‰æ–¹åº“å¯¼å…¥
import React, { useState, useEffect } from 'react';
import { useDispatch, useSelector } from 'react-redux';
import styled from 'styled-components';

// å†…éƒ¨æ¨¡å—å¯¼å…¥ï¼ˆæŒ‰è·¯å¾„å±‚çº§æ’åºï¼‰
import { Button } from '@renderer/components/common/Button';
import { useVoiceRecognition } from '@renderer/hooks/useVoiceRecognition';
import { VoiceService } from '@renderer/services/VoiceService';
import { logger } from '@shared/utils/logger';

// ç±»å‹å¯¼å…¥
import type { VoiceRecorderProps } from './VoiceRecorder.types';
import type { RootState } from '@renderer/store';

// âœ… æ¨èçš„å¯¼å‡ºæ–¹å¼
// å‘½åå¯¼å‡ºï¼ˆæ¨èï¼‰
export const VoiceRecorder: React.FC<VoiceRecorderProps> = () => {
  // ç»„ä»¶å®ç°
};

// é»˜è®¤å¯¼å‡ºï¼ˆç”¨äºé¡µé¢ç»„ä»¶ï¼‰
export default VoiceRecorder;

// ç±»å‹å¯¼å‡º
export type { VoiceRecorderProps };

// æ‰¹é‡å¯¼å‡º
export {
  VoiceRecorder,
  VoiceRecorderProps,
  useVoiceRecognition,
};
```

### 2.3 æ–‡ä»¶å‘½åè§„èŒƒ

```
# ç»„ä»¶æ–‡ä»¶
VoiceRecorder.tsx              # React ç»„ä»¶
VoiceRecorder.types.ts         # ç±»å‹å®šä¹‰
VoiceRecorder.styled.ts        # æ ·å¼æ–‡ä»¶
VoiceRecorder.test.tsx         # æµ‹è¯•æ–‡ä»¶
VoiceRecorder.stories.tsx      # Storybook æ–‡ä»¶

# æœåŠ¡æ–‡ä»¶
VoiceService.ts                # æœåŠ¡ç±»
voice.service.ts               # æœåŠ¡å‡½æ•°

# å·¥å…·æ–‡ä»¶
voice.utils.ts                 # å·¥å…·å‡½æ•°
voice.constants.ts             # å¸¸é‡å®šä¹‰
voice.types.ts                 # ç±»å‹å®šä¹‰

# Hook æ–‡ä»¶
useVoiceRecognition.ts         # è‡ªå®šä¹‰ Hook
useVoiceRecognition.test.ts    # Hook æµ‹è¯•

# é¡µé¢æ–‡ä»¶
MainPage.tsx                   # é¡µé¢ç»„ä»¶
main-page.route.ts             # è·¯ç”±é…ç½®
```

## 3. Git æäº¤è§„èŒƒ

### 3.1 æäº¤ä¿¡æ¯æ ¼å¼

```bash
# æäº¤ä¿¡æ¯æ ¼å¼
<type>(<scope>): <subject>

<body>

<footer>
```

### 3.2 æäº¤ç±»å‹

```bash
# ä¸»è¦ç±»å‹
feat:     æ–°åŠŸèƒ½
fix:      ä¿®å¤ bug
docs:     æ–‡æ¡£æ›´æ–°
style:    ä»£ç æ ¼å¼è°ƒæ•´ï¼ˆä¸å½±å“åŠŸèƒ½ï¼‰
refactor: é‡æ„ä»£ç 
perf:     æ€§èƒ½ä¼˜åŒ–
test:     æµ‹è¯•ç›¸å…³
chore:    æ„å»ºè¿‡ç¨‹æˆ–è¾…åŠ©å·¥å…·çš„å˜åŠ¨

# ç¤ºä¾‹
feat(voice): æ·»åŠ è¯­éŸ³è¯†åˆ«åŠŸèƒ½
fix(ui): ä¿®å¤æŒ‰é’®ç‚¹å‡»æ— å“åº”é—®é¢˜
docs(readme): æ›´æ–°å®‰è£…è¯´æ˜
style(components): ç»Ÿä¸€ç»„ä»¶ä»£ç æ ¼å¼
refactor(services): é‡æ„ API æœåŠ¡å±‚
perf(voice): ä¼˜åŒ–è¯­éŸ³å¤„ç†æ€§èƒ½
test(components): æ·»åŠ æŒ‰é’®ç»„ä»¶æµ‹è¯•
chore(deps): æ›´æ–°ä¾èµ–åŒ…ç‰ˆæœ¬
```

### 3.3 åˆ†æ”¯ç®¡ç†è§„èŒƒ

```bash
# åˆ†æ”¯å‘½åè§„èŒƒ
main                    # ä¸»åˆ†æ”¯
develop                 # å¼€å‘åˆ†æ”¯
feature/voice-recognition  # åŠŸèƒ½åˆ†æ”¯
bugfix/login-error      # ä¿®å¤åˆ†æ”¯
hotfix/critical-bug     # çƒ­ä¿®å¤åˆ†æ”¯
release/v1.0.0          # å‘å¸ƒåˆ†æ”¯

# åˆ†æ”¯å·¥ä½œæµ
1. ä» develop åˆ›å»º feature åˆ†æ”¯
2. åœ¨ feature åˆ†æ”¯å¼€å‘åŠŸèƒ½
3. å®Œæˆååˆ›å»º PR åˆ° develop
4. ä»£ç å®¡æŸ¥é€šè¿‡ååˆå¹¶
5. å®šæœŸä» develop åˆ›å»º release åˆ†æ”¯
6. æµ‹è¯•é€šè¿‡ååˆå¹¶åˆ° main å¹¶æ‰“æ ‡ç­¾
```

## 4. ä»£ç å®¡æŸ¥è§„èŒƒ

### 4.1 å®¡æŸ¥æ¸…å•

```markdown
## ä»£ç å®¡æŸ¥æ¸…å•

### åŠŸèƒ½æ€§
- [ ] ä»£ç å®ç°ç¬¦åˆéœ€æ±‚
- [ ] è¾¹ç•Œæ¡ä»¶å¤„ç†æ­£ç¡®
- [ ] é”™è¯¯å¤„ç†å®Œå–„
- [ ] æ€§èƒ½è¡¨ç°è‰¯å¥½

### ä»£ç è´¨é‡
- [ ] ä»£ç ç»“æ„æ¸…æ™°
- [ ] å‘½åè§„èŒƒåˆç†
- [ ] æ³¨é‡Šå……åˆ†å‡†ç¡®
- [ ] æ— é‡å¤ä»£ç 

### å®‰å…¨æ€§
- [ ] è¾“å…¥éªŒè¯å®Œå–„
- [ ] æ•æ„Ÿä¿¡æ¯ä¿æŠ¤
- [ ] æƒé™æ§åˆ¶æ­£ç¡®
- [ ] æ— å®‰å…¨æ¼æ´

### æµ‹è¯•
- [ ] å•å…ƒæµ‹è¯•è¦†ç›–
- [ ] é›†æˆæµ‹è¯•é€šè¿‡
- [ ] è¾¹ç•Œæµ‹è¯•å®Œæ•´
- [ ] æ€§èƒ½æµ‹è¯•è¾¾æ ‡
```

### 4.2 å®¡æŸ¥æµç¨‹

```markdown
1. è‡ªæ£€é˜¶æ®µ
   - å¼€å‘è€…è‡ªè¡Œæ£€æŸ¥ä»£ç 
   - è¿è¡Œæ‰€æœ‰æµ‹è¯•
   - ç¡®ä¿æ„å»ºæˆåŠŸ

2. åŒè¡Œå®¡æŸ¥
   - è‡³å°‘ä¸€ååŒäº‹å®¡æŸ¥
   - å…³æ³¨ä»£ç è´¨é‡å’Œé€»è¾‘
   - æå‡ºæ”¹è¿›å»ºè®®

3. æŠ€æœ¯è´Ÿè´£äººå®¡æŸ¥
   - æ¶æ„è®¾è®¡åˆç†æ€§
   - æŠ€æœ¯æ–¹æ¡ˆå¯è¡Œæ€§
   - ä»£ç è§„èŒƒéµå¾ª

4. æœ€ç»ˆç¡®è®¤
   - æ‰€æœ‰é—®é¢˜è§£å†³
   - æµ‹è¯•å…¨éƒ¨é€šè¿‡
   - æ–‡æ¡£æ›´æ–°å®Œæˆ
```

## 5. æµ‹è¯•è§„èŒƒ

### 5.1 å•å…ƒæµ‹è¯•è§„èŒƒ

```typescript
// VoiceRecorder.test.tsx
import React from 'react';
import { render, screen, fireEvent, waitFor } from '@testing-library/react';
import { VoiceRecorder } from './VoiceRecorder';
import { VoiceRecorderProps } from './VoiceRecorder.types';

// æ¨¡æ‹Ÿä¾èµ–
jest.mock('@renderer/hooks/useVoiceRecognition', () => ({
  useVoiceRecognition: jest.fn(() => ({
    isRecording: false,
    volume: 0,
    startRecording: jest.fn(),
    stopRecording: jest.fn(),
  })),
}));

describe('VoiceRecorder', () => {
  const defaultProps: VoiceRecorderProps = {
    onStart: jest.fn(),
    onStop: jest.fn(),
    onResult: jest.fn(),
  };

  beforeEach(() => {
    jest.clearAllMocks();
  });

  it('åº”è¯¥æ­£ç¡®æ¸²æŸ“ç»„ä»¶', () => {
    render(<VoiceRecorder {...defaultProps} />);

    expect(screen.getByRole('button')).toBeInTheDocument();
    expect(screen.getByText('å¼€å§‹')).toBeInTheDocument();
  });

  it('ç‚¹å‡»æŒ‰é’®åº”è¯¥å¼€å§‹å½•éŸ³', async () => {
    render(<VoiceRecorder {...defaultProps} />);

    const button = screen.getByRole('button');
    fireEvent.click(button);

    await waitFor(() => {
      expect(defaultProps.onStart).toHaveBeenCalledTimes(1);
    });
  });

  it('ç¦ç”¨çŠ¶æ€ä¸‹ä¸åº”è¯¥å“åº”ç‚¹å‡»', () => {
    render(<VoiceRecorder {...defaultProps} disabled />);

    const button = screen.getByRole('button');
    fireEvent.click(button);

    expect(defaultProps.onStart).not.toHaveBeenCalled();
  });

  it('åº”è¯¥æ­£ç¡®å¤„ç†å½•éŸ³çŠ¶æ€å˜åŒ–', () => {
    const { rerender } = render(<VoiceRecorder {...defaultProps} />);

    // æ¨¡æ‹Ÿå½•éŸ³çŠ¶æ€
    jest.mocked(useVoiceRecognition).mockReturnValue({
      isRecording: true,
      volume: 50,
      startRecording: jest.fn(),
      stopRecording: jest.fn(),
    });

    rerender(<VoiceRecorder {...defaultProps} />);

    expect(screen.getByText('åœæ­¢')).toBeInTheDocument();
  });
});
```

### 5.2 é›†æˆæµ‹è¯•è§„èŒƒ

```typescript
// voice-workflow.integration.test.ts
import { app } from 'electron';
import { VoiceService } from '@renderer/services/VoiceService';
import { AIService } from '@renderer/services/AIService';

describe('è¯­éŸ³è¯†åˆ«å·¥ä½œæµé›†æˆæµ‹è¯•', () => {
  let voiceService: VoiceService;
  let aiService: AIService;

  beforeAll(async () => {
    // åˆå§‹åŒ–æµ‹è¯•ç¯å¢ƒ
    voiceService = new VoiceService();
    aiService = new AIService();
  });

  afterAll(async () => {
    // æ¸…ç†æµ‹è¯•ç¯å¢ƒ
    await voiceService.cleanup();
  });

  it('åº”è¯¥å®Œæˆå®Œæ•´çš„è¯­éŸ³è¯†åˆ«åˆ°AIå›ç­”æµç¨‹', async () => {
    // 1. å¼€å§‹è¯­éŸ³è¯†åˆ«
    await voiceService.startRecognition();
    expect(voiceService.isRecording).toBe(true);

    // 2. æ¨¡æ‹Ÿè¯­éŸ³è¾“å…¥
    const mockAudioData = new ArrayBuffer(1024);
    const recognitionResult = await voiceService.processAudio(mockAudioData);
    expect(recognitionResult).toBeDefined();

    // 3. è·å–AIå›ç­”
    const aiResponse = await aiService.getResponse(recognitionResult, 'normal');
    expect(aiResponse).toBeDefined();
    expect(aiResponse.length).toBeGreaterThan(0);

    // 4. åœæ­¢è¯­éŸ³è¯†åˆ«
    await voiceService.stopRecognition();
    expect(voiceService.isRecording).toBe(false);
  });
});
```

### 5.3 E2E æµ‹è¯•è§„èŒƒ

```typescript
// login-flow.e2e.test.ts
import { Application } from 'spectron';
import { resolve } from 'path';

describe('ç™»å½•æµç¨‹ E2E æµ‹è¯•', () => {
  let app: Application;

  beforeAll(async () => {
    app = new Application({
      path: resolve(__dirname, '../../../node_modules/.bin/electron'),
      args: [resolve(__dirname, '../../../build/main/index.js')],
    });

    await app.start();
  });

  afterAll(async () => {
    if (app && app.isRunning()) {
      await app.stop();
    }
  });

  it('åº”è¯¥æ˜¾ç¤ºç™»å½•ç•Œé¢', async () => {
    const windowCount = await app.client.getWindowCount();
    expect(windowCount).toBe(1);

    const title = await app.client.getTitle();
    expect(title).toBe('AIé¢è¯•åŠ©æ‰‹');

    const emailInput = await app.client.$('input[type="email"]');
    expect(await emailInput.isDisplayed()).toBe(true);
  });

  it('åº”è¯¥èƒ½å¤Ÿå®Œæˆç™»å½•æµç¨‹', async () => {
    // è¾“å…¥é‚®ç®±
    await app.client.$('input[type="email"]').setValue('test@example.com');

    // ç‚¹å‡»å‘é€éªŒè¯ç 
    await app.client.$('button[data-testid="send-code"]').click();

    // ç­‰å¾…éªŒè¯ç è¾“å…¥æ¡†å‡ºç°
    await app.client.waitForExist('input[data-testid="verification-code"]');

    // è¾“å…¥éªŒè¯ç 
    await app.client.$('input[data-testid="verification-code"]').setValue('123456');

    // ç‚¹å‡»ç™»å½•
    await app.client.$('button[data-testid="login"]').click();

    // éªŒè¯ç™»å½•æˆåŠŸ
    await app.client.waitForExist('[data-testid="main-interface"]');
    const mainInterface = await app.client.$('[data-testid="main-interface"]');
    expect(await mainInterface.isDisplayed()).toBe(true);
  });
});
```

## 6. æ€§èƒ½ä¼˜åŒ–è§„èŒƒ

### 6.1 React æ€§èƒ½ä¼˜åŒ–

```typescript
// âœ… ä½¿ç”¨ React.memo ä¼˜åŒ–ç»„ä»¶æ¸²æŸ“
export const VoiceRecorder = React.memo<VoiceRecorderProps>(({
  onStart,
  onStop,
  disabled
}) => {
  // ç»„ä»¶å®ç°
}, (prevProps, nextProps) => {
  // è‡ªå®šä¹‰æ¯”è¾ƒå‡½æ•°
  return prevProps.disabled === nextProps.disabled;
});

// âœ… ä½¿ç”¨ useCallback ä¼˜åŒ–å‡½æ•°å¼•ç”¨
const handleStart = useCallback(() => {
  if (!disabled) {
    onStart();
  }
}, [disabled, onStart]);

// âœ… ä½¿ç”¨ useMemo ä¼˜åŒ–è®¡ç®—ç»“æœ
const processedData = useMemo(() => {
  return expensiveCalculation(rawData);
}, [rawData]);

// âœ… ä½¿ç”¨ lazy loading ä¼˜åŒ–ç»„ä»¶åŠ è½½
const SettingsPage = lazy(() => import('./pages/SettingsPage'));

// âœ… ä½¿ç”¨ Suspense å¤„ç†åŠ è½½çŠ¶æ€
<Suspense fallback={<Loading />}>
  <SettingsPage />
</Suspense>
```

### 6.2 å†…å­˜ç®¡ç†è§„èŒƒ

```typescript
// âœ… æ­£ç¡®æ¸…ç†å‰¯ä½œç”¨
useEffect(() => {
  const subscription = voiceService.subscribe(handleVoiceResult);
  const timer = setInterval(updateVolume, 100);

  return () => {
    subscription.unsubscribe();
    clearInterval(timer);
  };
}, []);

// âœ… æ­£ç¡®ç®¡ç†äº‹ä»¶ç›‘å¬å™¨
useEffect(() => {
  const handleKeyPress = (event: KeyboardEvent) => {
    // å¤„ç†æŒ‰é”®äº‹ä»¶
  };

  window.addEventListener('keydown', handleKeyPress);

  return () => {
    window.removeEventListener('keydown', handleKeyPress);
  };
}, []);

// âœ… æ­£ç¡®ç®¡ç† WebSocket è¿æ¥
useEffect(() => {
  const ws = new WebSocket('wss://api.example.com');

  ws.onmessage = handleMessage;
  ws.onerror = handleError;

  return () => {
    ws.close();
  };
}, []);
```

## 7. é”™è¯¯å¤„ç†è§„èŒƒ

### 7.1 é”™è¯¯è¾¹ç•Œ

```typescript
// ErrorBoundary.tsx
import React, { Component, ErrorInfo, ReactNode } from 'react';
import { logger } from '@shared/utils/logger';

interface Props {
  children: ReactNode;
  fallback?: ReactNode;
}

interface State {
  hasError: boolean;
  error?: Error;
}

export class ErrorBoundary extends Component<Props, State> {
  constructor(props: Props) {
    super(props);
    this.state = { hasError: false };
  }

  static getDerivedStateFromError(error: Error): State {
    return { hasError: true, error };
  }

  componentDidCatch(error: Error, errorInfo: ErrorInfo) {
    logger.error('React Error Boundary caught an error:', {
      error: error.message,
      stack: error.stack,
      componentStack: errorInfo.componentStack,
    });
  }

  render() {
    if (this.state.hasError) {
      return this.props.fallback || (
        <div className="error-fallback">
          <h2>å‡ºç°äº†ä¸€äº›é—®é¢˜</h2>
          <p>è¯·åˆ·æ–°é¡µé¢é‡è¯•ï¼Œå¦‚æœé—®é¢˜æŒç»­å­˜åœ¨ï¼Œè¯·è”ç³»æŠ€æœ¯æ”¯æŒã€‚</p>
          <button onClick={() => window.location.reload()}>
            åˆ·æ–°é¡µé¢
          </button>
        </div>
      );
    }

    return this.props.children;
  }
}
```

### 7.2 å¼‚æ­¥é”™è¯¯å¤„ç†

```typescript
// âœ… æ¨èçš„å¼‚æ­¥é”™è¯¯å¤„ç†æ–¹å¼
const fetchUserData = async (userId: string): Promise<User | null> => {
  try {
    const response = await apiClient.get(`/users/${userId}`);
    return response.data;
  } catch (error) {
    // è®°å½•é”™è¯¯
    logger.error('è·å–ç”¨æˆ·æ•°æ®å¤±è´¥:', {
      userId,
      error: error instanceof Error ? error.message : String(error),
      stack: error instanceof Error ? error.stack : undefined,
    });

    // æ ¹æ®é”™è¯¯ç±»å‹è¿›è¡Œä¸åŒå¤„ç†
    if (error instanceof NetworkError) {
      throw new Error('ç½‘ç»œè¿æ¥å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè®¾ç½®');
    } else if (error instanceof AuthError) {
      throw new Error('è®¤è¯å¤±è´¥ï¼Œè¯·é‡æ–°ç™»å½•');
    } else {
      throw new Error('è·å–ç”¨æˆ·æ•°æ®å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•');
    }
  }
};

// âœ… ä½¿ç”¨ Result æ¨¡å¼å¤„ç†é”™è¯¯
type Result<T, E = Error> =
  | { success: true; data: T }
  | { success: false; error: E };

const safeApiCall = async <T>(
  apiCall: () => Promise<T>
): Promise<Result<T>> => {
  try {
    const data = await apiCall();
    return { success: true, data };
  } catch (error) {
    return {
      success: false,
      error: error instanceof Error ? error : new Error(String(error))
    };
  }
};

// ä½¿ç”¨ç¤ºä¾‹
const result = await safeApiCall(() => fetchUserData('123'));
if (result.success) {
  console.log('ç”¨æˆ·æ•°æ®:', result.data);
} else {
  console.error('è·å–å¤±è´¥:', result.error.message);
}
```

## 8. å®‰å…¨è§„èŒƒ

### 8.1 è¾“å…¥éªŒè¯

```typescript
// âœ… è¾“å…¥éªŒè¯å·¥å…·
import { z } from 'zod';

// å®šä¹‰éªŒè¯æ¨¡å¼
const EmailSchema = z.string().email('è¯·è¾“å…¥æœ‰æ•ˆçš„é‚®ç®±åœ°å€');
const PasswordSchema = z.string()
  .min(8, 'å¯†ç è‡³å°‘8ä½')
  .regex(/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)/, 'å¯†ç å¿…é¡»åŒ…å«å¤§å°å†™å­—æ¯å’Œæ•°å­—');

const UserInputSchema = z.object({
  email: EmailSchema,
  password: PasswordSchema,
  age: z.number().min(18, 'å¹´é¾„å¿…é¡»å¤§äº18å²').max(120, 'å¹´é¾„ä¸èƒ½è¶…è¿‡120å²'),
});

// éªŒè¯å‡½æ•°
export const validateUserInput = (input: unknown) => {
  try {
    return UserInputSchema.parse(input);
  } catch (error) {
    if (error instanceof z.ZodError) {
      throw new ValidationError(error.errors[0].message);
    }
    throw error;
  }
};

// ä½¿ç”¨ç¤ºä¾‹
const handleSubmit = (formData: unknown) => {
  try {
    const validatedData = validateUserInput(formData);
    // å¤„ç†éªŒè¯é€šè¿‡çš„æ•°æ®
  } catch (error) {
    if (error instanceof ValidationError) {
      showErrorMessage(error.message);
    }
  }
};
```

### 8.2 æ•æ„Ÿæ•°æ®å¤„ç†

```typescript
// âœ… æ•æ„Ÿæ•°æ®åŠ å¯†å­˜å‚¨
import CryptoJS from 'crypto-js';

class SecureStorage {
  private readonly secretKey: string;

  constructor() {
    // ä»ç¯å¢ƒå˜é‡æˆ–å®‰å…¨ä½ç½®è·å–å¯†é’¥
    this.secretKey = process.env.ENCRYPTION_KEY || this.generateKey();
  }

  // åŠ å¯†å­˜å‚¨
  setSecureItem(key: string, value: string): void {
    const encrypted = CryptoJS.AES.encrypt(value, this.secretKey).toString();
    localStorage.setItem(key, encrypted);
  }

  // è§£å¯†è¯»å–
  getSecureItem(key: string): string | null {
    const encrypted = localStorage.getItem(key);
    if (!encrypted) return null;

    try {
      const decrypted = CryptoJS.AES.decrypt(encrypted, this.secretKey);
      return decrypted.toString(CryptoJS.enc.Utf8);
    } catch (error) {
      logger.error('è§£å¯†å¤±è´¥:', error);
      return null;
    }
  }

  // åˆ é™¤æ•æ„Ÿæ•°æ®
  removeSecureItem(key: string): void {
    localStorage.removeItem(key);
  }

  private generateKey(): string {
    return CryptoJS.lib.WordArray.random(256/8).toString();
  }
}

// ä½¿ç”¨ç¤ºä¾‹
const secureStorage = new SecureStorage();
secureStorage.setSecureItem('user_token', 'sensitive_token_value');
const token = secureStorage.getSecureItem('user_token');
```

### 8.3 XSS é˜²æŠ¤

```typescript
// âœ… XSS é˜²æŠ¤å·¥å…·
import DOMPurify from 'dompurify';

// æ¸…ç† HTML å†…å®¹
export const sanitizeHTML = (html: string): string => {
  return DOMPurify.sanitize(html, {
    ALLOWED_TAGS: ['b', 'i', 'em', 'strong', 'p', 'br'],
    ALLOWED_ATTR: [],
  });
};

// è½¬ä¹‰ç”¨æˆ·è¾“å…¥
export const escapeHTML = (text: string): string => {
  const div = document.createElement('div');
  div.textContent = text;
  return div.innerHTML;
};

// React ç»„ä»¶ä¸­å®‰å…¨æ¸²æŸ“
const SafeContent: React.FC<{ content: string }> = ({ content }) => {
  const sanitizedContent = useMemo(() => sanitizeHTML(content), [content]);

  return (
    <div
      dangerouslySetInnerHTML={{ __html: sanitizedContent }}
    />
  );
};
```

## 9. æ–‡æ¡£è§„èŒƒ

### 9.1 ä»£ç æ³¨é‡Šè§„èŒƒ

```typescript
/**
 * è¯­éŸ³è¯†åˆ«æœåŠ¡ç±»
 *
 * æä¾›è¯­éŸ³è¯†åˆ«ã€éŸ³é¢‘å¤„ç†ç­‰åŠŸèƒ½
 * æ”¯æŒå¤šç§è¯­éŸ³è¯†åˆ«å¼•æ“å’Œé…ç½®é€‰é¡¹
 *
 * @example
 * ```typescript
 * const voiceService = new VoiceService({
 *   engine: 'tencent',
 *   language: 'zh-CN'
 * });
 *
 * await voiceService.startRecognition();
 * ```
 */
export class VoiceService {
  private recognition: SpeechRecognition | null = null;
  private isRecording = false;

  /**
   * æ„é€ å‡½æ•°
   *
   * @param options - é…ç½®é€‰é¡¹
   * @param options.engine - è¯­éŸ³è¯†åˆ«å¼•æ“ ('tencent' | 'baidu' | 'ali')
   * @param options.language - è¯†åˆ«è¯­è¨€ï¼Œé»˜è®¤ 'zh-CN'
   * @param options.continuous - æ˜¯å¦è¿ç»­è¯†åˆ«ï¼Œé»˜è®¤ true
   */
  constructor(private options: VoiceServiceOptions) {
    this.initializeRecognition();
  }

  /**
   * å¼€å§‹è¯­éŸ³è¯†åˆ«
   *
   * @throws {PermissionError} å½“éº¦å…‹é£æƒé™è¢«æ‹’ç»æ—¶
   * @throws {NotSupportedError} å½“æµè§ˆå™¨ä¸æ”¯æŒè¯­éŸ³è¯†åˆ«æ—¶
   *
   * @returns Promise<void>
   */
  async startRecognition(): Promise<void> {
    if (this.isRecording) {
      logger.warn('è¯­éŸ³è¯†åˆ«å·²åœ¨è¿›è¡Œä¸­');
      return;
    }

    try {
      await this.requestMicrophonePermission();
      this.recognition?.start();
      this.isRecording = true;
      logger.info('è¯­éŸ³è¯†åˆ«å·²å¼€å§‹');
    } catch (error) {
      logger.error('å¯åŠ¨è¯­éŸ³è¯†åˆ«å¤±è´¥:', error);
      throw error;
    }
  }

  /**
   * åœæ­¢è¯­éŸ³è¯†åˆ«
   *
   * @returns void
   */
  stopRecognition(): void {
    if (!this.isRecording) return;

    this.recognition?.stop();
    this.isRecording = false;
    logger.info('è¯­éŸ³è¯†åˆ«å·²åœæ­¢');
  }

  /**
   * è¯·æ±‚éº¦å…‹é£æƒé™
   *
   * @private
   * @returns Promise<void>
   */
  private async requestMicrophonePermission(): Promise<void> {
    // å®ç°ç»†èŠ‚...
  }
}
```

### 9.2 README æ–‡æ¡£è§„èŒƒ

```markdown
# AIé¢è¯•åŠ©æ‰‹æ¡Œé¢ç«¯

## é¡¹ç›®ç®€ä»‹

AIé¢è¯•åŠ©æ‰‹æ˜¯ä¸€æ¬¾åŸºäº Electron + React + TypeScript å¼€å‘çš„æ¡Œé¢åº”ç”¨ï¼Œæ—¨åœ¨ä¸ºé¢è¯•è€…æä¾›å®æ—¶çš„AIè¾…åŠ©å›ç­”åŠŸèƒ½ã€‚

## æ ¸å¿ƒåŠŸèƒ½

- ğŸ¤ **å®æ—¶è¯­éŸ³è¯†åˆ«**: æ”¯æŒè…¾è®¯äº‘ã€ç™¾åº¦äº‘ç­‰å¤šç§è¯­éŸ³è¯†åˆ«æœåŠ¡
- ğŸ¤– **AIæ™ºèƒ½å›ç­”**: æ¥å…¥æ™ºè°±AIï¼Œæä¾›ç²¾å‡†çš„é¢è¯•é—®é¢˜å›ç­”
- ğŸ‘» **å±å¹•å…±äº«èº²é¿**: è‡ªåŠ¨æ£€æµ‹å±å¹•å…±äº«å¹¶éšè—åº”ç”¨
- âŒ¨ï¸ **å…¨å±€å¿«æ·é”®**: æ”¯æŒè‡ªå®šä¹‰å¿«æ·é”®æ§åˆ¶
- ğŸ¨ **ç•Œé¢é€æ˜åº¦**: å¯è°ƒèŠ‚çª—å£é€æ˜åº¦ï¼Œèå…¥æ¡Œé¢ç¯å¢ƒ
- ğŸ” **å®‰å…¨ç™»å½•**: é‚®ç®±éªŒè¯ç ç™»å½•ï¼Œä¿æŠ¤ç”¨æˆ·éšç§

## æŠ€æœ¯æ ˆ

- **ä¸»æ¡†æ¶**: Electron 28+
- **å‰ç«¯**: React 18 + TypeScript 5
- **UIåº“**: Ant Design + Styled Components
- **çŠ¶æ€ç®¡ç†**: Redux Toolkit + RTK Query
- **æ„å»ºå·¥å…·**: Webpack 5 + Babel
- **æµ‹è¯•æ¡†æ¶**: Jest + React Testing Library
- **ä»£ç è§„èŒƒ**: ESLint + Prettier + Husky

## å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

- Node.js >= 18.0.0
- npm >= 8.0.0 æˆ– yarn >= 1.22.0

### å®‰è£…ä¾èµ–

```bash
# ä½¿ç”¨ npm
npm install

# æˆ–ä½¿ç”¨ yarn
yarn install
```

### å¼€å‘æ¨¡å¼

```bash
# å¯åŠ¨å¼€å‘æœåŠ¡å™¨
npm run dev

# æˆ–
yarn dev
```

### æ„å»ºåº”ç”¨

```bash
# æ„å»ºç”Ÿäº§ç‰ˆæœ¬
npm run build

# æ‰“åŒ…åº”ç”¨
npm run dist

# é’ˆå¯¹ç‰¹å®šå¹³å°æ‰“åŒ…
npm run dist:win    # Windows
npm run dist:mac    # macOS
npm run dist:linux  # Linux
```

## é¡¹ç›®ç»“æ„

```
src/
â”œâ”€â”€ main/           # ä¸»è¿›ç¨‹ä»£ç 
â”œâ”€â”€ renderer/       # æ¸²æŸ“è¿›ç¨‹ä»£ç 
â”œâ”€â”€ shared/         # å…±äº«ä»£ç 
â””â”€â”€ assets/         # é™æ€èµ„æº
```

è¯¦ç»†çš„é¡¹ç›®ç»“æ„è¯´æ˜è¯·å‚è€ƒ [é¡¹ç›®ç»“æ„è®¾è®¡æ–‡æ¡£](docs/é¡¹ç›®ç»“æ„è®¾è®¡.md)ã€‚

## å¼€å‘æŒ‡å—

- [æŠ€æœ¯æ¶æ„è®¾è®¡](docs/æŠ€æœ¯æ¶æ„è®¾è®¡.md)
- [åŠŸèƒ½äº¤äº’è®¾è®¡](docs/åŠŸèƒ½äº¤äº’è®¾è®¡.md)
- [è§†è§‰UIåŸå‹](docs/è§†è§‰UIåŸå‹.md)
- [å¼€å‘è§„èŒƒ](docs/å¼€å‘è§„èŒƒ.md)

## è´¡çŒ®æŒ‡å—

1. Fork æœ¬ä»“åº“
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. åˆ›å»º Pull Request

## è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£è¯¦æƒ…ã€‚

## è”ç³»æˆ‘ä»¬

- é¡¹ç›®ä¸»é¡µ: [GitHub Repository](https://github.com/username/offerHelper)
- é—®é¢˜åé¦ˆ: [Issues](https://github.com/username/offerHelper/issues)
- é‚®ç®±: <support@example.com>

```

### 9.3 API æ–‡æ¡£è§„èŒƒ

```markdown
# API æ–‡æ¡£

## IPC é€šä¿¡æ¥å£

### çª—å£æ§åˆ¶

#### window:minimize

æœ€å°åŒ–çª—å£

**è°ƒç”¨æ–¹å¼:**
```typescript
await window.electronAPI.window.minimize();
```

**å‚æ•°:** æ— 

**è¿”å›å€¼:** `Promise<void>`

**ç¤ºä¾‹:**

```typescript
const handleMinimize = async () => {
  try {
    await window.electronAPI.window.minimize();
    console.log('çª—å£å·²æœ€å°åŒ–');
  } catch (error) {
    console.error('æœ€å°åŒ–å¤±è´¥:', error);
  }
};
```

#### window:setOpacity

è®¾ç½®çª—å£é€æ˜åº¦

**è°ƒç”¨æ–¹å¼:**

```typescript
await window.electronAPI.window.setOpacity(opacity);
```

**å‚æ•°:**

- `opacity` (number): é€æ˜åº¦å€¼ï¼ŒèŒƒå›´ 0-1

**è¿”å›å€¼:** `Promise<void>`

**å¼‚å¸¸:**

- `InvalidArgumentError`: å½“é€æ˜åº¦å€¼è¶…å‡ºèŒƒå›´æ—¶æŠ›å‡º

**ç¤ºä¾‹:**

```typescript
// è®¾ç½®50%é€æ˜åº¦
await window.electronAPI.window.setOpacity(0.5);
```

### è¯­éŸ³æ§åˆ¶

#### voice:start

å¼€å§‹è¯­éŸ³è¯†åˆ«

**è°ƒç”¨æ–¹å¼:**

```typescript
await window.electronAPI.voice.start();
```

**å‚æ•°:** æ— 

**è¿”å›å€¼:** `Promise<void>`

**å¼‚å¸¸:**

- `PermissionError`: éº¦å…‹é£æƒé™è¢«æ‹’ç»
- `DeviceError`: éº¦å…‹é£è®¾å¤‡ä¸å¯ç”¨

**äº‹ä»¶:**

- `voice:result`: è¯†åˆ«ç»“æœäº‹ä»¶
- `voice:error`: è¯†åˆ«é”™è¯¯äº‹ä»¶

**ç¤ºä¾‹:**

```typescript
// å¼€å§‹è¯­éŸ³è¯†åˆ«
await window.electronAPI.voice.start();

// ç›‘å¬è¯†åˆ«ç»“æœ
window.electronAPI.voice.onResult((text) => {
  console.log('è¯†åˆ«ç»“æœ:', text);
});
```

```

## 10. éƒ¨ç½²è§„èŒƒ

### 10.1 ç¯å¢ƒé…ç½®

```bash
# ç”Ÿäº§ç¯å¢ƒå˜é‡
NODE_ENV=production
ELECTRON_IS_DEV=false

# API é…ç½®
AI_API_BASE_URL=https://api.zhipuai.cn
AI_API_KEY=your_api_key_here

# è¯­éŸ³è¯†åˆ«é…ç½®
TENCENT_ASR_SECRET_ID=your_secret_id
TENCENT_ASR_SECRET_KEY=your_secret_key

# æ›´æ–°æœåŠ¡é…ç½®
AUTO_UPDATE_URL=https://update.example.com
UPDATE_CHECK_INTERVAL=3600000

# æ—¥å¿—é…ç½®
LOG_LEVEL=info
LOG_MAX_SIZE=10485760
LOG_MAX_FILES=5

# å®‰å…¨é…ç½®
ENCRYPTION_KEY=your_encryption_key_here
CSP_REPORT_URI=https://csp-report.example.com
```

### 10.2 æ„å»ºé…ç½®

```json
{
  "build": {
    "appId": "com.company.offerHelper",
    "productName": "AIé¢è¯•åŠ©æ‰‹",
    "directories": {
      "output": "dist"
    },
    "files": [
      "build/**/*",
      "node_modules/**/*",
      "package.json"
    ],
    "mac": {
      "category": "public.app-category.productivity",
      "hardenedRuntime": true,
      "entitlements": "build/entitlements.mac.plist",
      "entitlementsInherit": "build/entitlements.mac.plist"
    },
    "win": {
      "target": "nsis",
      "certificateFile": "build/certificate.p12",
      "certificatePassword": "${env.CERTIFICATE_PASSWORD}"
    },
    "publish": {
      "provider": "github",
      "owner": "username",
      "repo": "offerHelper"
    }
  }
}
```

### 10.3 CI/CD é…ç½®

```yaml
# .github/workflows/build.yml
name: Build and Release

on:
  push:
    tags:
      - 'v*'

jobs:
  build:
    runs-on: ${{ matrix.os }}
    strategy:
      matrix:
        os: [macos-latest, windows-latest, ubuntu-latest]

    steps:
    - uses: actions/checkout@v3

    - name: Setup Node.js
      uses: actions/setup-node@v3
      with:
        node-version: '18'
        cache: 'npm'

    - name: Install dependencies
      run: npm ci

    - name: Run tests
      run: npm test

    - name: Build application
      run: npm run build

    - name: Package application
      run: npm run dist
      env:
        GH_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        CERTIFICATE_PASSWORD: ${{ secrets.CERTIFICATE_PASSWORD }}

    - name: Upload artifacts
      uses: actions/upload-artifact@v3
      with:
        name: ${{ matrix.os }}-build
        path: dist/
```

è¿™ä¸ªå¼€å‘è§„èŒƒæ–‡æ¡£æ¶µç›–äº†AIé¢è¯•åŠ©æ‰‹æ¡Œé¢ç«¯é¡¹ç›®çš„å®Œæ•´å¼€å‘æ ‡å‡†ï¼ŒåŒ…æ‹¬ä»£ç è§„èŒƒã€æµ‹è¯•è§„èŒƒã€å®‰å…¨è§„èŒƒã€æ–‡æ¡£è§„èŒƒå’Œéƒ¨ç½²è§„èŒƒç­‰å„ä¸ªæ–¹é¢ï¼Œä¸ºå›¢é˜Ÿåä½œå’Œé¡¹ç›®ç»´æŠ¤æä¾›äº†ç»Ÿä¸€çš„æ ‡å‡†ã€‚
