<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>OfferHelper - ç™»å½•ç•Œé¢</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      background: #1a1a1a;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      padding: 20px;
    }

    .login-container {
      width: 360px;
      background: rgba(0, 0, 0, 0.95);
      border-radius: 12px;
      border: 1px solid rgba(255, 255, 255, 0.1);
      backdrop-filter: blur(20px);
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.6);
      overflow: hidden;
    }

    /* æ ‡é¢˜æ  */
    .title-bar {
      height: 40px;
      background: rgba(255, 255, 255, 0.05);
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0 16px;
      border-bottom: 1px solid rgba(255, 255, 255, 0.05);
    }

    .title-content {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .login-title {
      color: #f3f4f6;
      font-size: 14px;
      font-weight: 500;
    }

    .close-btn {
      width: 20px;
      height: 20px;
      border-radius: 50%;
      border: none;
      background: #ff5f57;
      color: white;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 12px;
      transition: all 0.2s ease;
    }

    .close-btn:hover {
      transform: scale(1.1);
    }

    /* ç™»å½•å†…å®¹ */
    .login-content {
      padding: 32px 24px;
      text-align: center;
    }

    /* Logoå’Œæ ‡é¢˜ */
    .login-header {
      margin-bottom: 32px;
    }

    .app-logo {
      width: 64px;
      height: 64px;
      background: linear-gradient(135deg, #667eea, #764ba2);
      border-radius: 16px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 32px;
      margin: 0 auto 16px;
      box-shadow: 0 4px 16px rgba(102, 126, 234, 0.3);
    }

    .welcome-title {
      color: #f3f4f6;
      font-size: 20px;
      font-weight: 600;
      margin-bottom: 8px;
    }

    .welcome-subtitle {
      color: #9ca3af;
      font-size: 14px;
      line-height: 1.4;
    }

    /* ç™»å½•è¡¨å• */
    .login-form {
      display: flex;
      flex-direction: column;
      gap: 16px;
    }

    .form-group {
      text-align: left;
    }

    .form-label {
      color: #d1d5db;
      font-size: 13px;
      font-weight: 500;
      margin-bottom: 8px;
      display: block;
    }

    .form-input {
      width: 100%;
      height: 44px;
      padding: 0 12px;
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 8px;
      color: #f3f4f6;
      font-size: 14px;
      outline: none;
      transition: all 0.2s ease;
    }

    .form-input:focus {
      border-color: #667eea;
      box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
      background: rgba(255, 255, 255, 0.08);
    }

    .form-input::placeholder {
      color: #6b7280;
    }

    /* éªŒè¯ç è¾“å…¥ç»„ */
    .code-input-group {
      display: flex;
      gap: 8px;
      align-items: center;
    }

    .code-input {
      flex: 1;
    }

    .send-code-btn {
      height: 44px;
      padding: 0 16px;
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 8px;
      color: #667eea;
      font-size: 12px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.2s ease;
      white-space: nowrap;
    }

    .send-code-btn:hover:not(:disabled) {
      background: rgba(102, 126, 234, 0.1);
      border-color: #667eea;
    }

    .send-code-btn:disabled {
      color: #6b7280;
      cursor: not-allowed;
    }

    /* ç™»å½•æŒ‰é’® */
    .login-btn {
      width: 100%;
      height: 48px;
      background: linear-gradient(135deg, #667eea, #764ba2);
      border: none;
      border-radius: 8px;
      color: white;
      font-size: 15px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s ease;
      margin-top: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
    }

    .login-btn:hover:not(:disabled) {
      transform: translateY(-1px);
      box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
    }

    .login-btn:disabled {
      opacity: 0.6;
      cursor: not-allowed;
      transform: none;
    }

    /* åŠ è½½åŠ¨ç”» */
    .loading-spinner {
      width: 16px;
      height: 16px;
      border: 2px solid rgba(255, 255, 255, 0.3);
      border-top: 2px solid white;
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }

    @keyframes spin {
      0% {
        transform: rotate(0deg);
      }

      100% {
        transform: rotate(360deg);
      }
    }

    /* é”™è¯¯æç¤º */
    .error-message {
      background: rgba(239, 68, 68, 0.1);
      border: 1px solid rgba(239, 68, 68, 0.2);
      border-radius: 6px;
      padding: 8px 12px;
      color: #fca5a5;
      font-size: 12px;
      text-align: center;
      margin-top: 12px;
      display: none;
    }

    .error-message.show {
      display: block;
    }

    /* æˆåŠŸæç¤º */
    .success-message {
      background: rgba(16, 185, 129, 0.1);
      border: 1px solid rgba(16, 185, 129, 0.2);
      border-radius: 6px;
      padding: 8px 12px;
      color: #6ee7b7;
      font-size: 12px;
      text-align: center;
      margin-top: 12px;
      display: none;
    }

    .success-message.show {
      display: block;
    }

    /* åº•éƒ¨é“¾æ¥ */
    .login-footer {
      margin-top: 24px;
      padding-top: 20px;
      border-top: 1px solid rgba(255, 255, 255, 0.05);
    }

    .footer-text {
      color: #6b7280;
      font-size: 12px;
      line-height: 1.4;
    }

    .footer-link {
      color: #667eea;
      text-decoration: none;
      transition: color 0.2s ease;
    }

    .footer-link:hover {
      color: #8b9cf7;
    }

    /* ç™»å½•çŠ¶æ€ */
    .login-step {
      display: none;
    }

    .login-step.active {
      display: block;
    }

    /* å“åº”å¼è°ƒæ•´ */
    @media (max-width: 400px) {
      .login-container {
        width: 100%;
        margin: 0 10px;
      }

      .login-content {
        padding: 24px 20px;
      }
    }
  </style>
</head>

<body>
  <div class="login-container">
    <!-- æ ‡é¢˜æ  -->
    <div class="title-bar">
      <div class="title-content">
        <span class="login-title">ğŸ” ç”¨æˆ·ç™»å½•</span>
      </div>
      <button class="close-btn">Ã—</button>
    </div>

    <!-- ç™»å½•å†…å®¹ -->
    <div class="login-content">
      <!-- Logoå’Œæ ‡é¢˜ -->
      <div class="login-header">
        <div class="app-logo">ğŸ¯</div>
        <h1 class="welcome-title">æ¬¢è¿ä½¿ç”¨ OfferHelper</h1>
        <p class="welcome-subtitle">ä¸“ä¸šçš„é¢è¯•AIè¾…åŠ©å·¥å…·<br>è®©æ¯ä¸€æ¬¡é¢è¯•éƒ½å……æ»¡ä¿¡å¿ƒ</p>
      </div>

      <!-- ç™»å½•è¡¨å• -->
      <form class="login-form" id="loginForm">
        <!-- ç¬¬ä¸€æ­¥ï¼šè¾“å…¥é‚®ç®± -->
        <div class="login-step active" id="emailStep">
          <div class="form-group">
            <label class="form-label" for="email">é‚®ç®±åœ°å€</label>
            <input type="email" id="email" class="form-input" placeholder="è¯·è¾“å…¥æ‚¨çš„é‚®ç®±åœ°å€" required>
          </div>

          <button type="button" class="login-btn" id="sendCodeBtn">
            <span id="sendCodeText">å‘é€éªŒè¯ç </span>
          </button>
        </div>

        <!-- ç¬¬äºŒæ­¥ï¼šè¾“å…¥éªŒè¯ç  -->
        <div class="login-step" id="codeStep">
          <div class="form-group">
            <label class="form-label" for="email-display">é‚®ç®±åœ°å€</label>
            <input type="email" id="emailDisplay" class="form-input" readonly
              style="background: rgba(255, 255, 255, 0.02); color: #9ca3af;">
          </div>

          <div class="form-group">
            <label class="form-label" for="verificationCode">éªŒè¯ç </label>
            <div class="code-input-group">
              <input type="text" id="verificationCode" class="form-input code-input" placeholder="è¯·è¾“å…¥6ä½éªŒè¯ç "
                maxlength="6" required>
              <button type="button" class="send-code-btn" id="resendBtn">
                <span id="resendText">é‡æ–°å‘é€</span>
              </button>
            </div>
          </div>

          <button type="button" class="login-btn" id="loginBtn">
            <span id="loginText">ç™»å½•</span>
          </button>

          <div style="text-align: center; margin-top: 16px;">
            <button type="button" class="footer-link" id="backBtn"
              style="background: none; border: none; cursor: pointer;">
              â† è¿”å›ä¿®æ”¹é‚®ç®±
            </button>
          </div>
        </div>

        <!-- é”™è¯¯æç¤º -->
        <div class="error-message" id="errorMessage"></div>

        <!-- æˆåŠŸæç¤º -->
        <div class="success-message" id="successMessage"></div>
      </form>

      <!-- åº•éƒ¨ä¿¡æ¯ -->
      <div class="login-footer">
        <p class="footer-text">
          é¦–æ¬¡ä½¿ç”¨ï¼ŸéªŒè¯é‚®ç®±åå°†è‡ªåŠ¨æ³¨å†Œè´¦å·<br>
          é‡åˆ°é—®é¢˜ï¼Ÿ<a href="#" class="footer-link">è”ç³»å®¢æœ</a>
        </p>
      </div>
    </div>
  </div>

  <script>
    // åº”ç”¨çŠ¶æ€
    let appState = {
      currentStep: 'email', // 'email' | 'code'
      email: '',
      isLoading: false,
      countdown: 0
    }

    // DOM å…ƒç´ 
    const elements = {
      emailStep: document.getElementById('emailStep'),
      codeStep: document.getElementById('codeStep'),
      email: document.getElementById('email'),
      emailDisplay: document.getElementById('emailDisplay'),
      verificationCode: document.getElementById('verificationCode'),
      sendCodeBtn: document.getElementById('sendCodeBtn'),
      sendCodeText: document.getElementById('sendCodeText'),
      loginBtn: document.getElementById('loginBtn'),
      loginText: document.getElementById('loginText'),
      resendBtn: document.getElementById('resendBtn'),
      resendText: document.getElementById('resendText'),
      backBtn: document.getElementById('backBtn'),
      errorMessage: document.getElementById('errorMessage'),
      successMessage: document.getElementById('successMessage'),
      closeBtn: document.querySelector('.close-btn')
    }

    // éªŒè¯é‚®ç®±æ ¼å¼
    function validateEmail (email)
    {
      const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/
      return emailRegex.test(email)
    }

    // æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯
    function showError (message)
    {
      elements.errorMessage.textContent = message
      elements.errorMessage.className = 'error-message show'
      elements.successMessage.className = 'success-message'
    }

    // æ˜¾ç¤ºæˆåŠŸä¿¡æ¯
    function showSuccess (message)
    {
      elements.successMessage.textContent = message
      elements.successMessage.className = 'success-message show'
      elements.errorMessage.className = 'error-message'
    }

    // éšè—æ‰€æœ‰æç¤º
    function hideMessages ()
    {
      elements.errorMessage.className = 'error-message'
      elements.successMessage.className = 'success-message'
    }

    // åˆ‡æ¢åˆ°éªŒè¯ç æ­¥éª¤
    function switchToCodeStep ()
    {
      appState.currentStep = 'code'
      elements.emailStep.className = 'login-step'
      elements.codeStep.className = 'login-step active'
      elements.emailDisplay.value = appState.email
      elements.verificationCode.focus()
    }

    // åˆ‡æ¢åˆ°é‚®ç®±æ­¥éª¤
    function switchToEmailStep ()
    {
      appState.currentStep = 'email'
      elements.emailStep.className = 'login-step active'
      elements.codeStep.className = 'login-step'
      elements.verificationCode.value = ''
      elements.email.focus()
      hideMessages()
    }

    // å¼€å§‹å€’è®¡æ—¶
    function startCountdown (seconds)
    {
      appState.countdown = seconds
      elements.resendBtn.disabled = true

      const timer = setInterval(() =>
      {
        appState.countdown--
        elements.resendText.textContent = `${appState.countdown}såé‡å‘`

        if (appState.countdown <= 0) {
          clearInterval(timer)
          elements.resendBtn.disabled = false
          elements.resendText.textContent = 'é‡æ–°å‘é€'
        }
      }, 1000)
    }

    // è®¾ç½®åŠ è½½çŠ¶æ€
    function setLoading (button, textElement, isLoading)
    {
      if (isLoading) {
        button.disabled = true
        textElement.innerHTML = '<div class="loading-spinner"></div>'
        appState.isLoading = true
      } else {
        button.disabled = false
        appState.isLoading = false
      }
    }

    // å‘é€éªŒè¯ç 
    async function sendVerificationCode ()
    {
      const email = elements.email.value.trim()

      if (!email) {
        showError('è¯·è¾“å…¥é‚®ç®±åœ°å€')
        elements.email.focus()
        return
      }

      if (!validateEmail(email)) {
        showError('è¯·è¾“å…¥æœ‰æ•ˆçš„é‚®ç®±åœ°å€')
        elements.email.focus()
        return
      }

      appState.email = email
      setLoading(elements.sendCodeBtn, elements.sendCodeText, true)
      hideMessages()

      try {
        // æ¨¡æ‹ŸAPIè°ƒç”¨
        await new Promise(resolve => setTimeout(resolve, 2000))

        // æ¨¡æ‹ŸæˆåŠŸ
        showSuccess(`éªŒè¯ç å·²å‘é€è‡³ ${email}`)
        setTimeout(() =>
        {
          switchToCodeStep()
          startCountdown(60)
        }, 1000)

      } catch (error) {
        showError('å‘é€éªŒè¯ç å¤±è´¥ï¼Œè¯·é‡è¯•')
      } finally {
        elements.sendCodeText.textContent = 'å‘é€éªŒè¯ç '
        elements.sendCodeBtn.disabled = false
        appState.isLoading = false
      }
    }

    // é‡æ–°å‘é€éªŒè¯ç 
    async function resendVerificationCode ()
    {
      setLoading(elements.resendBtn, elements.resendText, true)
      hideMessages()

      try {
        // æ¨¡æ‹ŸAPIè°ƒç”¨
        await new Promise(resolve => setTimeout(resolve, 1500))

        showSuccess('éªŒè¯ç å·²é‡æ–°å‘é€')
        startCountdown(60)

      } catch (error) {
        showError('é‡æ–°å‘é€å¤±è´¥ï¼Œè¯·é‡è¯•')
      } finally {
        if (appState.countdown <= 0) {
          elements.resendText.textContent = 'é‡æ–°å‘é€'
          elements.resendBtn.disabled = false
        }
        appState.isLoading = false
      }
    }

    // éªŒè¯ç™»å½•
    async function verifyLogin ()
    {
      const code = elements.verificationCode.value.trim()

      if (!code) {
        showError('è¯·è¾“å…¥éªŒè¯ç ')
        elements.verificationCode.focus()
        return
      }

      if (code.length !== 6) {
        showError('è¯·è¾“å…¥6ä½éªŒè¯ç ')
        elements.verificationCode.focus()
        return
      }

      setLoading(elements.loginBtn, elements.loginText, true)
      hideMessages()

      try {
        // æ¨¡æ‹ŸAPIè°ƒç”¨
        await new Promise(resolve => setTimeout(resolve, 2000))

        // æ¨¡æ‹Ÿç™»å½•æˆåŠŸ
        showSuccess('ç™»å½•æˆåŠŸï¼æ­£åœ¨è·³è½¬...')

        setTimeout(() =>
        {
          alert('ç™»å½•æˆåŠŸï¼\n\nç”¨æˆ·ä¿¡æ¯ï¼š\né‚®ç®±ï¼š' + appState.email + '\nä»¤ç‰Œï¼šmock-jwt-token-' + Date.now())
        }, 1000)

      } catch (error) {
        showError('éªŒè¯ç é”™è¯¯ï¼Œè¯·é‡è¯•')
        elements.verificationCode.focus()
      } finally {
        elements.loginText.textContent = 'ç™»å½•'
        elements.loginBtn.disabled = false
        appState.isLoading = false
      }
    }

    // äº‹ä»¶ç›‘å¬
    elements.sendCodeBtn.addEventListener('click', sendVerificationCode)
    elements.resendBtn.addEventListener('click', resendVerificationCode)
    elements.loginBtn.addEventListener('click', verifyLogin)
    elements.backBtn.addEventListener('click', switchToEmailStep)
    elements.closeBtn.addEventListener('click', () =>
    {
      if (confirm('ç¡®å®šè¦å…³é—­ç™»å½•çª—å£å—ï¼Ÿ')) {
        window.close()
      }
    })

    // å›è½¦é”®æäº¤
    elements.email.addEventListener('keypress', (e) =>
    {
      if (e.key === 'Enter' && !appState.isLoading) {
        sendVerificationCode()
      }
    })

    elements.verificationCode.addEventListener('keypress', (e) =>
    {
      if (e.key === 'Enter' && !appState.isLoading) {
        verifyLogin()
      }
    })

    // éªŒè¯ç è¾“å…¥é™åˆ¶ï¼ˆåªå…è®¸æ•°å­—ï¼‰
    elements.verificationCode.addEventListener('input', (e) =>
    {
      e.target.value = e.target.value.replace(/[^0-9]/g, '')
    })

    // è‡ªåŠ¨èšç„¦
    elements.email.focus();
  </script>
</body>

</html>